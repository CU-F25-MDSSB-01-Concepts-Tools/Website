<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.33">

  <meta name="author" content="Jan Lorenz">
  <title>Data Science Concepts / Data Science Tools – W#07: Models in Science, Linear Model, Nonlinear Models</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto-f563837468303362081e247dddd440d0.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">W#07: Models in Science, Linear Model, Nonlinear Models</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Jan Lorenz 
</div>
</div>
</div>

</section><section id="TOC">
<nav role="doc-toc"> 
<h2 id="toc-title">Table of contents</h2>
<ul>
<li><a href="#/models-in-science" id="/toc-models-in-science">Models in Science</a></li>
<li><a href="#/linear-model" id="/toc-linear-model">Linear Model</a></li>
<li><a href="#/fitting-models" id="/toc-fitting-models">Fitting Models</a></li>
<li><a href="#/linear-models-and-dummy-variables" id="/toc-linear-models-and-dummy-variables">Linear Models and Dummy Variables</a></li>
<li><a href="#/linear-models-and-r-squared" id="/toc-linear-models-and-r-squared">Linear models and R-squared</a></li>
<li><a href="#/linear-models-with-more-predictors" id="/toc-linear-models-with-more-predictors">Linear models with more predictors</a></li>
<li><a href="#/nonlinear-models" id="/toc-nonlinear-models">Nonlinear Models</a></li>
</ul>
</nav>
</section>
<section id="preliminaries" class="slide level2">
<h2>Preliminaries</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb1-3"><a></a><span class="fu">library</span>(palmerpenguins)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section>
<section id="models-in-science" class="title-slide slide level1 center">
<h1>Models in Science</h1>

</section>
<section id="what-is-a-model" class="slide level2 smaller" data-background-color="khaki">
<h2>What is a model?</h2>
<ul>
<li>A model is an informative representation of an object, person or system.</li>
</ul>
<p><img data-src="https://upload.wikimedia.org/wikipedia/commons/4/46/Astrid_Andersen_01.jpg" height="200"> <img data-src="https://upload.wikimedia.org/wikipedia/commons/b/b8/Beta-D-Gulopyranose_Molek%C3%BClbaukasten_9288.JPG" height="200"> <img data-src="https://upload.wikimedia.org/wikipedia/commons/7/73/AtmosphericModelSchematic.png" height="200"></p>
<ul>
<li>A model is a <span style="color:blue;"><strong>simplified</strong></span> representation of the real world focusing on the essential parts for its <span style="color:blue;"><strong>purpose</strong></span>.</li>
</ul>

<aside><div>
<p>Source: <a href="https://en.wikipedia.org/wiki/Model" class="uri">https://en.wikipedia.org/wiki/Model</a></p>
</div></aside></section>
<section id="scientific-modeling" class="slide level2 smaller" data-background-color="khaki">
<h2>Scientific Modeling</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Scientific modeling</strong> is an activity that produces models representing empirical objects, phenomena, and physical processes, to make a particular part or feature of the world easier to</p>
<ul>
<li>understand,</li>
<li>define,</li>
<li>quantify,</li>
<li>visualize, or</li>
<li>simulate.</li>
</ul>
</div><div class="column" style="width:50%;">
<p><img data-src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/f2/MathModel.svg/2560px-MathModel.svg.png"></p>
<h4 id="famous-wisdom">Famous wisdom</h4>
<blockquote>
<p><a href="https://en.wikipedia.org/wiki/All_models_are_wrong">All models are wrong, but some are useful.</a></p>
</blockquote>
</div></div>

<aside><div>
<p>Source: <a href="https://en.wikipedia.org/wiki/Scientific_modelling" class="uri">https://en.wikipedia.org/wiki/Scientific_modelling</a></p>
</div></aside></section>
<section id="model-purposes-and-data-analysis" class="slide level2 smaller" data-background-color="khaki">
<h2>Model Purposes and Data Analysis</h2>
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li><strong>Agent-based models</strong> and <strong>differential equations</strong>
<ul>
<li>are used to <strong>explain</strong> the <strong>dynamics</strong> of one or more variables (typically) over time. They are used to answer <span style="color:blue;"><em>mechanistic questions</em></span>.</li>
</ul></li>
<li><span style="color:blue;"><strong>Variable-based models</strong></span>
<ul>
<li>are used to specify relations between variables</li>
<li>to <strong>explain</strong> relations and make <strong>predictions</strong>.</li>
<li>Used to answer <span style="color:blue;"><em>inferential</em></span> and <span style="color:blue;"><em>predictive questions</em></span>.<br>
</li>
<li>(With experimental and theoretical effort also for <span style="color:blue;"><em>causal questions</em></span>.)</li>
</ul></li>
</ul>
</div><div class="column" style="width:40%;">
<p><img data-src="img/DataAnalysisFlowChart_LeekPeng.jpeg"></p>
</div></div>
<div class="fragment">
<p>The most basic variable-based model is the <span style="color:blue;"><strong>linear model</strong></span>.</p>
</div>
</section>
<section id="models-to-learn-from-data" class="slide level2 smaller" data-background-color="khaki">
<h2>Models to Learn from Data</h2>
<p>In much of the following we use a <em>narrower</em> definition of <strong>model</strong>:</p>
<p>A <strong>mathematical model</strong> that consists of <strong>variables</strong> and <strong>functions</strong>.</p>
<div class="columns">
<div class="column" style="width:50%;">
<p>Different names and roles of <span style="color:blue;"><strong>variables</strong></span>:</p>
<ul>
<li>random variables</li>
<li>covariates</li>
<li>predictors</li>
<li>latent variables</li>
<li>features</li>
<li>targets</li>
<li>outcomes</li>
</ul>
</div><div class="column" style="width:50%;">
<p><span style="color:blue;"><strong>Functions</strong></span> relate variables to each other</p>
<ul>
<li>In a linear model we model one variable as a weighted sum of the other variables</li>
</ul>
<p>Once a model (setup of variables and functions) is specified, modelers use <span style="color:blue;"><strong>Data</strong></span> to find the <em>best</em> function, called</p>
<ul>
<li>estimation</li>
<li>training</li>
<li>fitting</li>
<li>learning</li>
</ul>
</div></div>
</section>
<section id="modeling-mindsets" class="slide level2 smaller" data-background-color="khaki">
<h2>Modeling Mindsets</h2>
<p>Even within the setup of <em>Models to Learn from Data</em> there are many different <span style="color:blue;"><strong>Modeling Mindsets</strong></span></p>
<p><img data-src="img/ModelingMindsets.png"></p>

<aside><div>
<p>Molnar, C. (2022). <a href="https://books.google.de/books?id=qV-DzwEACAAJ">Modeling mindsets: The many cultures of learning from data.</a> Christoph Molnar c/o Mucbook Clubhouse.</p>
</div></aside></section>
<section id="modeling-mindsets-1" class="slide level2 smaller" data-background-color="khaki">
<h2>Modeling Mindsets</h2>
<p>Even within the setup of <em>Models to Learn from Data</em> there are many different <span style="color:blue;"><strong>Modeling Mindsets</strong></span></p>
<p><img data-src="img/ModelingMindsets_annotated.png"></p>

<aside><div>
<p>Molnar, C. (2022). <a href="https://books.google.de/books?id=qV-DzwEACAAJ">Modeling mindsets: The many cultures of learning from data.</a> Christoph Molnar c/o Mucbook Clubhouse.</p>
</div></aside></section></section>
<section>
<section id="linear-model" class="title-slide slide level1 center">
<h1>Linear Model</h1>
<p>The first work-horse model in data science</p>
</section>
<section id="hello-again-penguins" class="slide level2 scrollable smaller">
<h2>Hello again penguins!</h2>
<p>We use the dataset <a href="https://allisonhorst.github.io/palmerpenguins/">Palmer Penguins</a></p>
<p>Chinstrap, Gentoo, and Adélie Penguins</p>
<p><img data-src="https://upload.wikimedia.org/wikipedia/commons/0/08/South_Shetland-2016-Deception_Island%E2%80%93Chinstrap_penguin_%28Pygoscelis_antarctica%29_04.jpg" height="200"> <img data-src="https://upload.wikimedia.org/wikipedia/commons/0/00/Brown_Bluff-2016-Tabarin_Peninsula%E2%80%93Gentoo_penguin_%28Pygoscelis_papua%29_03.jpg" height="200"> <img data-src="https://upload.wikimedia.org/wikipedia/commons/e/e3/Hope_Bay-2016-Trinity_Peninsula%E2%80%93Ad%C3%A9lie_penguin_%28Pygoscelis_adeliae%29_04.jpg" height="200"></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 344 × 8
   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g
   &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;
 1 Adelie  Torgersen           39.1          18.7               181        3750
 2 Adelie  Torgersen           39.5          17.4               186        3800
 3 Adelie  Torgersen           40.3          18                 195        3250
 4 Adelie  Torgersen           NA            NA                  NA          NA
 5 Adelie  Torgersen           36.7          19.3               193        3450
 6 Adelie  Torgersen           39.3          20.6               190        3650
 7 Adelie  Torgersen           38.9          17.8               181        3625
 8 Adelie  Torgersen           39.2          19.6               195        4675
 9 Adelie  Torgersen           34.1          18.1               193        3475
10 Adelie  Torgersen           42            20.2               190        4250
# ℹ 334 more rows
# ℹ 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;</code></pre>
</div>
</div>
</section>
<section id="body-mass-in-grams" class="slide level2">
<h2>Body mass in grams</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb3-2"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(body_mass_g)) <span class="sc">+</span></span>
<span id="cb3-3"><a></a>  <span class="fu">geom_histogram</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="W07_files/figure-revealjs/unnamed-chunk-3-1.png" width="960" class="r-stretch"></section>
<section id="flipper-length-in-millimeters" class="slide level2">
<h2>Flipper length in millimeters</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb4-2"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(flipper_length_mm)) <span class="sc">+</span></span>
<span id="cb4-3"><a></a>  <span class="fu">geom_histogram</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="W07_files/figure-revealjs/unnamed-chunk-4-1.png" width="960" class="r-stretch"></section>
<section id="relate-variables-as-a-line" class="slide level2 smaller" data-background-color="aquamarine">
<h2>Relate variables as a line</h2>
<p>A <em>line</em> is a shift-scale transformation of the identity function usually written in the form</p>
<p><span class="math display">\[f(x) = a\cdot x + b\]</span></p>
<p>where <span style="color:red;"><span class="math inline">\(a\)</span> is the <em>slope</em></span>, <span style="color:blue;"><span class="math inline">\(b\)</span> is the <em>intercept</em></span>.<sup>1</sup></p>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a></a>a <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb5-2"><a></a>b <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb5-3"><a></a>func <span class="ot">&lt;-</span> <span class="cf">function</span>(x) a<span class="sc">*</span>x <span class="sc">+</span> b</span>
<span id="cb5-4"><a></a><span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_function</span>(<span class="at">fun =</span> func, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb5-5"><a></a> <span class="co"># Set axis limits and make axis equal</span></span>
<span id="cb5-6"><a></a>    <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="dv">2</span>)) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>)) <span class="sc">+</span> <span class="fu">coord_fixed</span>() <span class="sc">+</span> </span>
<span id="cb5-7"><a></a>    <span class="fu">geom_line</span>( <span class="co"># intercept line:</span></span>
<span id="cb5-8"><a></a>     <span class="at">data=</span><span class="fu">tibble</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="at">y=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)), </span>
<span id="cb5-9"><a></a>     <span class="at">mapping =</span> <span class="fu">aes</span>(x,y), </span>
<span id="cb5-10"><a></a>     <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb5-11"><a></a>    <span class="fu">geom_line</span>( <span class="co"># slope:</span></span>
<span id="cb5-12"><a></a>     <span class="at">data=</span><span class="fu">tibble</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="fl">1.5</span>,<span class="fl">1.5</span>),<span class="at">y=</span><span class="fu">c</span>(<span class="fl">1.25</span>,<span class="fl">1.75</span>)), </span>
<span id="cb5-13"><a></a>     <span class="at">mapping =</span> <span class="fu">aes</span>(x,y), </span>
<span id="cb5-14"><a></a>     <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb5-15"><a></a>    <span class="fu">geom_line</span>( <span class="co"># x-interval of length one:</span></span>
<span id="cb5-16"><a></a>     <span class="at">data=</span><span class="fu">tibble</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">1.5</span>),<span class="at">y=</span><span class="fu">c</span>(<span class="fl">1.25</span>,<span class="fl">1.25</span>)), </span>
<span id="cb5-17"><a></a>     <span class="at">mapping =</span> <span class="fu">aes</span>(x,y), <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb5-18"><a></a>    <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">24</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="W07_files/figure-revealjs/unnamed-chunk-5-1.png" width="960"></p>
</figure>
</div>
</div>
</div></div>
<aside><ol class="aside-footnotes"><li id="fn1"><p>This a scale and a shift in the <span class="math inline">\(y\)</span> direction. Note: For lines there is always an analog transformations on the <span class="math inline">\(x\)</span> direction.</p></li></ol></aside></section>
<section id="penguins-linear-model" class="slide level2 smaller">
<h2>Penguins: Linear model</h2>
<p><strong>Flipper length</strong> as a function of <strong>body mass</strong>.</p>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb6-2"><a></a> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> body_mass_g, </span>
<span id="cb6-3"><a></a>            <span class="at">y =</span> flipper_length_mm)) <span class="sc">+</span></span>
<span id="cb6-4"><a></a> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb6-5"><a></a> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, </span>
<span id="cb6-6"><a></a>             <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb6-7"><a></a> <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">24</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="W07_files/figure-revealjs/unnamed-chunk-6-1.png" width="960"></p>
</figure>
</div>
</div>
</div></div>
</section>
<section id="penguins-a-smooth-line" class="slide level2 smaller">
<h2>Penguins: A smooth line</h2>
<p><strong>Flipper length</strong> as a function of <strong>body mass</strong> with <code>loess</code><sup>1</sup> smoothing.</p>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb7-2"><a></a> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> body_mass_g, </span>
<span id="cb7-3"><a></a>            <span class="at">y =</span> flipper_length_mm)) <span class="sc">+</span></span>
<span id="cb7-4"><a></a> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb7-5"><a></a> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>) <span class="sc">+</span> </span>
<span id="cb7-6"><a></a> <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">24</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="W07_files/figure-revealjs/unnamed-chunk-7-1.png" width="960"></p>
</figure>
</div>
</div>
</div></div>
<p>This is a less theory-driven and more data-driven model. Why?<br>
<span class="fragment">We don’t have a simple mathematical form of the function.</span></p>
<aside><ol class="aside-footnotes"><li id="fn2"><p>loess = locally estimated scatterplot smoothing</p></li></ol></aside></section>
<section id="terminology-variable-based-models" class="slide level2 smaller" data-background-color="khaki">
<h2>Terminology variable-based models</h2>
<ul>
<li><strong>Response variable:</strong><sup>1</sup> Variable whose behavior or variation you are trying to understand, on the y-axis</li>
<li><strong>Explanatory variable(s):</strong><sup>2</sup> Other variable(s) that you want to use to explain the variation in the response, on the x-axis</li>
<li><strong>Predicted value:</strong> Output of the model function.
<ul>
<li>The model function gives the <strong>(expected) average value</strong> of the response variable conditioning on the explanatory variables</li>
<li><strong>Residual(s):</strong> A measure of how far away a case is from its predicted value (based on the particular model)<br>
Residual = Observed value minus Predicted value<br>
The residual tells how far above/below the expected value each case is</li>
</ul></li>
</ul>
<aside><ol class="aside-footnotes"><li id="fn3"><p>Also <strong>dependent variable</strong> in statistics or empirical social sciences.</p></li><li id="fn4"><p>Also <strong>independent variable(s)</strong> in statistics or empirical social sciences.</p></li></ol></aside></section>
<section id="more-explanatory-variables" class="slide level2 smaller">
<h2>More explanatory variables</h2>
<p>How does the relation between flipper length and body mass change with different species?</p>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb8-2"><a></a> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> body_mass_g, </span>
<span id="cb8-3"><a></a>            <span class="at">y =</span> flipper_length_mm, </span>
<span id="cb8-4"><a></a>            <span class="at">color =</span> species)) <span class="sc">+</span></span>
<span id="cb8-5"><a></a> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb8-6"><a></a> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb8-7"><a></a>             <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb8-8"><a></a> <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">24</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="W07_files/figure-revealjs/unnamed-chunk-8-1.png" width="960"></p>
</figure>
</div>
</div>
</div></div>
</section>
<section id="ggplot-hint-how-to-color-penguins-but-keep-one-model" class="slide level2 smaller">
<h2>ggplot-hint: How to color penguins but keep one model?</h2>
<p>Put the mapping of the color aesthetic into the <code>geom_point</code> command.</p>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb9-2"><a></a> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> body_mass_g, </span>
<span id="cb9-3"><a></a>            <span class="at">y =</span> flipper_length_mm)) <span class="sc">+</span></span>
<span id="cb9-4"><a></a> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> species)) <span class="sc">+</span></span>
<span id="cb9-5"><a></a> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb9-6"><a></a> <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">24</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="W07_files/figure-revealjs/unnamed-chunk-9-1.png" width="960"></p>
</figure>
</div>
</div>
</div></div>
</section>
<section id="beware-of-simpsons-paradox" class="slide level2 smaller" data-background-color="aquamarine">
<h2>Beware of Simpson’s paradox</h2>
<p>Slopes for all groups can be in the opposite direction of the main effect’s slope!</p>
<p><img data-src="https://upload.wikimedia.org/wikipedia/commons/f/fb/Simpsons_paradox_-_animation.gif" height="400"></p>

<aside><div>
<p>Source: <a href="https://en.wikipedia.org/wiki/Simpson%27s_paradox" class="uri">https://en.wikipedia.org/wiki/Simpson%27s_paradox</a></p>
</div></aside></section>
<section id="the-paradox-is-real" class="slide level2 smaller">
<h2>The paradox is real!</h2>
<p>How does the relation between bill length and body mass change with different species?</p>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb10-2"><a></a> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> bill_length_mm, </span>
<span id="cb10-3"><a></a>            <span class="at">y =</span> bill_depth_mm)) <span class="sc">+</span></span>
<span id="cb10-4"><a></a> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> species)) <span class="sc">+</span></span>
<span id="cb10-5"><a></a> <span class="fu">geom_smooth</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> species),</span>
<span id="cb10-6"><a></a>             <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb10-7"><a></a>             <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb10-8"><a></a> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb10-9"><a></a>                                                    <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb10-10"><a></a> <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">24</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="W07_files/figure-revealjs/unnamed-chunk-10-1.png" width="960"></p>
</figure>
</div>
</div>
</div></div>
</section>
<section id="models---upsides-and-downsides" class="slide level2 smaller" data-background-color="khaki">
<h2>Models - upsides and downsides</h2>
<ul>
<li>Models can reveal patterns that are not evident in a graph of the data. This is an advantage of modeling over simple visual inspection of data.
<ul>
<li>How would you visualize dependencies of more than two variables?</li>
</ul></li>
<li>The risk is that a model is imposing structure that is not really there in the real world data.
<ul>
<li>People imagined animal shapes in the stars. This is maybe a good model to detect and memorize shapes, but it has nothing to do with these animals.</li>
<li>Every model is a simplification of the real world, but there are good and bad models (for particular purposes).</li>
<li>A skeptical (but constructive) approach to a model is always advisable.</li>
</ul></li>
</ul>
</section>
<section id="variation-around-a-model" class="slide level2 smaller" data-background-color="khaki">
<h2>Variation around a model</h2>
<p>… is as interesting and important as the model!</p>
<p><em><span style="color:blue;"><strong>Statistics</strong></span> is the explanation of uncertainty of variation in the context of what remains unexplained.</em></p>
<ul>
<li>The scattered data of flipper length and body mass suggests that there maybe other factors that account for some parts of the variability.</li>
<li>Or is it randomness?</li>
<li>Adding more explanatory variables can help (but need not)</li>
</ul>
</section>
<section id="all-models-are-wrong" class="slide level2 smaller" data-background-color="khaki">
<h2><em>All models are wrong …</em></h2>
<p><em>… but some are useful.</em> (George Box)</p>
<p>Extending the range of the model:</p>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb11-2"><a></a> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> body_mass_g, </span>
<span id="cb11-3"><a></a>            <span class="at">y =</span> flipper_length_mm)) <span class="sc">+</span></span>
<span id="cb11-4"><a></a> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb11-5"><a></a> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, </span>
<span id="cb11-6"><a></a>             <span class="at">se =</span> <span class="cn">FALSE</span>, </span>
<span id="cb11-7"><a></a>                                                <span class="at">fullrange =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb11-8"><a></a>    <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">7000</span>)) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">230</span>)) <span class="sc">+</span></span>
<span id="cb11-9"><a></a> <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">24</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="W07_files/figure-revealjs/unnamed-chunk-11-1.png" width="960"></p>
</figure>
</div>
</div>
</div></div>
<ul>
<li>The model predicts that penguins with zero weight still have flippers of about 140 mm on average.</li>
<li>Is the model useless? <span class="fragment">Yes, around zero body mass. No, it works OK in the range of the body mass data.</span></li>
</ul>
</section>
<section id="two-model-purposes" class="slide level2 smaller" data-background-color="khaki">
<h2>Two model purposes</h2>
<p>Linear models can be used for:</p>
<ul>
<li><strong>Explanation:</strong> Understand the relationship of variables in a quantitative way.<br>
<em>For the linear model, interpret slope and intercept.</em>
<ul>
<li>In other words: We make <strong>inference</strong> about relations in any sample of penguins.</li>
</ul></li>
<li><strong>Prediction:</strong> Plug in new values for the explanatory variable(s) and receive the expected response value.<br>
<em>For the linear model, predict the flipper length of new penguins by their body mass.</em></li>
</ul>
</section></section>
<section>
<section id="fitting-models" class="title-slide slide level1 center">
<h1>Fitting Models</h1>
<p>Today: The linear model.</p>
</section>
<section id="in-r-tidymodels" class="slide level2">
<h2>In R: <code>tidymodels</code></h2>
<p><img data-src="https://datasciencebox.org/course-materials/_slides/u4-d02-fitting-interpreting-models/img/tidymodels.png"></p>

<aside><div>
<p>From <a href="https://datasciencebox.org" class="uri">https://datasciencebox.org</a></p>
</div></aside></section>
<section id="our-goal" class="slide level2">
<h2>Our goal</h2>
<p>Predict flipper length from body mass</p>
<p>average <code>flipper_length_mm</code> <span class="math inline">\(= \beta_0 + \beta_1\cdot\)</span> <code>body_mass_g</code></p>
</section>
<section id="step-1-specify-model" class="slide level2">
<h2>Step 1: Specify model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb12-2"><a></a><span class="fu">linear_reg</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear Regression Model Specification (regression)

Computational engine: lm </code></pre>
</div>
</div>
</section>
<section id="step-2-set-the-model-fitting-engine" class="slide level2">
<h2>Step 2: Set the model fitting <em>engine</em></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a></a><span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb14-2"><a></a>    <span class="fu">set_engine</span>(<span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear Regression Model Specification (regression)

Computational engine: lm </code></pre>
</div>
</div>
</section>
<section id="step-3-fit-model-and-estimate-parameters" class="slide level2 smaller">
<h2>Step 3: Fit model and estimate parameters</h2>
<p>Only now, the data and the variable selection comes in.</p>
<p>Use of <strong>formula syntax</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a></a><span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb16-2"><a></a>    <span class="fu">set_engine</span>(<span class="st">"lm"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb16-3"><a></a>    <span class="fu">fit</span>(flipper_length_mm <span class="sc">~</span> body_mass_g, <span class="at">data =</span> penguins)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>parsnip model object


Call:
stats::lm(formula = flipper_length_mm ~ body_mass_g, data = data)

Coefficients:
(Intercept)  body_mass_g  
  136.72956      0.01528  </code></pre>
</div>
</div>
<p><a href="http://parsnip.tidymodels.org"><code>parsnip</code></a> is package in <code>tidymodels</code> which is to provide a tidy, unified interface to models that can be used to try a range of models.</p>

<aside><div>
<p>Note: The fit command does not follow the tidyverse principle the data comes first. Instead, the formula comes first. This is to relate to existing traditions of a much older established way of modeling in base R.</p>
</div></aside></section>
<section id="what-does-the-output-say" class="slide level2 smaller">
<h2>What does the output say?</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a></a><span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb18-2"><a></a>    <span class="fu">set_engine</span>(<span class="st">"lm"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb18-3"><a></a>    <span class="fu">fit</span>(flipper_length_mm <span class="sc">~</span> body_mass_g, <span class="at">data =</span> penguins)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>parsnip model object


Call:
stats::lm(formula = flipper_length_mm ~ body_mass_g, data = data)

Coefficients:
(Intercept)  body_mass_g  
  136.72956      0.01528  </code></pre>
</div>
</div>
<div class="fragment">
<p>average <code>flipper_length_mm</code> <span class="math inline">\(= 136.72956 + 0.01528\cdot\)</span> <code>body_mass_g</code></p>
</div>
<div class="fragment">
<p><strong>Interpretation:</strong><br>
The penguins have a flipper length of 138 mm plus 0.01528 mm for each gram of body mass (that is 15.28 mm per kg). Penguins with zero mass have a flipper length of 138 mm. However, this is not in the range where the model was fitted.</p>
</div>
</section>
<section id="show-output-in-tidy-form" class="slide level2">
<h2>Show output in <em>tidy</em> form</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a></a><span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb20-2"><a></a>    <span class="fu">set_engine</span>(<span class="st">"lm"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb20-3"><a></a>    <span class="fu">fit</span>(flipper_length_mm <span class="sc">~</span> body_mass_g, <span class="at">data =</span> penguins) <span class="sc">|&gt;</span> </span>
<span id="cb20-4"><a></a>    <span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term        estimate std.error statistic   p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept) 137.      2.00          68.5 5.71e-201
2 body_mass_g   0.0153  0.000467      32.7 4.37e-107</code></pre>
</div>
</div>
</section>
<section id="parameter-estimation" class="slide level2 smaller" data-background-color="aquamarine">
<h2>Parameter estimation</h2>
<p>Notation from statistics: <span class="math inline">\(\beta\)</span>’s for the population parameters and <span class="math inline">\(\hat\beta\)</span>’s for the parameters estimated from the sample statistics.</p>
<p><span class="math display">\[\hat y = \beta_0 + \beta_1 x\]</span></p>
<p>The population parameters <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> we cannot have. (<span class="math inline">\(\hat y\)</span> stands for <em>predicted value of <span class="math inline">\(y\)</span></em>. )</p>
<div class="fragment">
<p>Instead, we estimate <span class="math inline">\(\hat\beta_0\)</span> and <span class="math inline">\(\hat\beta_1\)</span> in the model fitting process.</p>
<p><span class="math display">\[\hat y = \hat\beta_0 + \hat\beta_1 x\]</span></p>
<div style="background-color:khaki;padding:10px;">
<p>A typical follow-up data analysis question is what the fitted values <span class="math inline">\(\hat\beta_0\)</span> and <span class="math inline">\(\hat\beta_1\)</span> tell us about the (unknown) population-wide values <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>?</p>
<p>This is the typical <span style="'color:blue"><strong>inferential question</strong></span>.</p>
</div>
</div>
</section>
<section id="parsnip-model-objects" class="slide level2 smaller">
<h2><code>parsnip</code> model objects</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a></a>pengmod <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb22-2"><a></a>    <span class="fu">set_engine</span>(<span class="st">"lm"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb22-3"><a></a>    <span class="fu">fit</span>(flipper_length_mm <span class="sc">~</span> body_mass_g, <span class="at">data =</span> penguins)</span>
<span id="cb22-4"><a></a><span class="fu">class</span>(pengmod) <span class="co"># attributes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "_lm"       "model_fit"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a></a><span class="fu">typeof</span>(pengmod) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "list"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a></a><span class="fu">names</span>(pengmod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "lvl"          "ordered"      "spec"         "fit"          "preproc"     
[6] "elapsed"      "censor_probs"</code></pre>
</div>
</div>
<div class="fragment">
<p>Most interesting for us for now: <code>$fit</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a></a>pengmod<span class="sc">$</span>fit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
stats::lm(formula = flipper_length_mm ~ body_mass_g, data = data)

Coefficients:
(Intercept)  body_mass_g  
  136.72956      0.01528  </code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>Notice: <code>parsnip model object</code> is now missing in the output.</p>
</div>
</section>
<section id="fit-is-the-object-created-by-lm-base-r" class="slide level2 smaller scrollable">
<h2><code>$fit</code> is the object created by <code>lm</code> (base R)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a></a><span class="fu">names</span>(pengmod<span class="sc">$</span>fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "coefficients"  "residuals"     "effects"       "rank"         
 [5] "fitted.values" "assign"        "qr"            "df.residual"  
 [9] "na.action"     "xlevels"       "call"          "terms"        
[13] "model"        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a></a>pengmod<span class="sc">$</span>fit<span class="sc">$</span>call</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>stats::lm(formula = flipper_length_mm ~ body_mass_g, data = data)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a></a>pengmod<span class="sc">$</span>fit<span class="sc">$</span>coefficients</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> (Intercept)  body_mass_g 
136.72955927   0.01527592 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a></a>pengmod<span class="sc">$</span>fit<span class="sc">$</span>fitted.values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1        2        3        5        6        7        8        9 
194.0142 194.7780 186.3763 189.4315 192.4867 192.1048 208.1445 189.8134 
      10       11       12       13       14       15       16       17 
201.6522 187.1401 193.2504 185.6125 194.7780 203.9436 193.2504 189.4315 
      18       19       20       21       22       23       24       25 
205.4712 187.5220 200.8884 188.6677 191.7229 194.7780 197.0694 194.7780 
      26       27       28       29       30       31       32       33 
194.7780 190.9591 185.6125 184.8487 197.0694 186.3763 196.3056 187.1401 
      34       35       36       37       38       39       40       41 
196.3056 187.5220 200.1246 197.0694 190.9591 187.1401 207.7626 184.8487 
      42       43       44       45       46       47       48       49 
196.3056 184.0849 203.9436 182.5573 206.9988 189.0496 182.1754 189.4315 
      50       51       52       53       54       55       56       57 
200.1246 190.1953 202.4160 189.4315 198.5970 181.0297 193.2504 190.9591 
      58       59       60       61       62       63       64       65 
194.7780 180.2659 194.0142 184.8487 203.9436 191.7229 198.5970 180.2659 
      66       67       68       69       70       71       72       73 
197.0694 187.9039 199.3608 183.3211 204.7074 191.7229 196.3056 190.9591 
      74       75       76       77       78       79       80       81 
200.1246 193.2504 201.6522 193.2504 196.3056 190.9591 197.8332 185.6125 
      82       83       84       85       86       87       88       89 
208.5264 194.7780 200.8884 187.9039 190.9591 194.7780 190.1953 197.0694 
      90       91       92       93       94       95       96       97 
191.7229 190.9591 202.4160 188.6677 204.7074 187.1401 202.4160 193.2504 
      98       99      100      101      102      103      104      105 
203.1798 181.0297 199.3608 193.6323 208.9083 183.7030 201.6522 181.4116 
     106      107      108      109      110      111      112      113 
190.9591 194.0142 196.3056 185.2306 209.6721 195.1599 206.9988 185.6125 
     114      115      116      117      118      119      120      121 
202.0341 196.3056 198.9789 181.0297 194.3961 187.9039 187.5220 184.8487 
     122      123      124      125      126      127      128      129 
190.1953 189.4315 195.9237 183.3211 197.8332 186.7582 202.4160 183.3211 
     130      131      132      133      134      135      136      137 
197.8332 187.5220 190.1953 190.1953 205.0893 189.0496 196.3056 185.2306 
     138      139      140      141      142      143      144      145 
197.4513 188.6677 201.6522 188.6677 189.8134 183.3211 193.6323 182.5573 
     146      147      148      149      150      151      152      153 
192.4867 201.6522 189.8134 189.4315 194.0142 193.2504 197.8332 205.4712 
     154      155      156      157      158      159      160      161 
223.8023 204.7074 223.8023 219.2195 206.2350 210.0540 216.1643 203.9436 
     162      163      164      165      166      167      168      169 
215.4005 207.7626 221.5109 207.7626 226.0937 200.8884 226.0937 200.1246 
     170      171      172      173      174      175      176      177 
232.9678 210.0540 218.4557 223.8023 213.1091 203.9436 213.8729 213.1091 
     178      179      180      181      182      183      184      185 
214.6367 199.3608 223.0385 206.9988 221.5109 216.9281 208.5264 213.8729 
     186      187      188      189      190      191      192      193 
229.1488 215.4005 219.2195 212.3453 216.9281 203.1798 218.4557 197.0694 
     194      195      196      197      198      199      200      201 
223.8023 202.4160 209.2902 221.5109 211.5815 200.8884 219.2195 214.6367 
     202      203      204      205      206      207      208      209 
217.6919 210.8177 217.6919 203.9436 213.1091 211.5815 213.8729 202.4160 
     210      211      212      213      214      215      216      217 
213.1091 204.7074 221.5109 200.8884 217.6919 203.9436 223.0385 208.5264 
     218      219      220      221      222      223      224      225 
223.8023 207.7626 225.3299 208.5264 221.5109 209.2902 213.1091 214.6367 
     226      227      228      229      230      231      232      233 
216.1643 208.5264 225.3299 206.9988 228.3851 209.2902 227.6213 207.3807 
     234      235      236      237      238      239      240      241 
219.9833 208.9083 218.4557 209.2902 222.2747 206.9988 217.6919 211.1996 
     242      243      244      245      246      247      248      249 
221.5109 212.3453 219.2195 209.2902 223.0385 210.8177 216.1643 211.9634 
     250      251      252      253      254      255      256      257 
211.1996 207.3807 216.9281 210.8177 222.2747 212.7272 220.7471 208.9083 
     258      259      260      261      262      263      264      265 
220.7471 208.5264 220.7471 206.6169 220.7471 213.1091 227.6213 207.7626 
     266      267      268      269      270      271      273      274 
220.7471 203.5617 226.0937 211.1996 228.3851 211.9634 210.8177 224.5661 
     275      276      277      278      279      280      281      282 
216.1643 219.2195 190.1953 196.3056 192.4867 190.5772 193.6323 197.0694 
     283      284      285      286      287      288      289      290 
186.3763 194.0142 200.1246 193.2504 194.7780 194.3961 193.2504 198.5970 
     291      292      293      294      295      296      297      298 
191.3410 198.5970 187.1401 193.2504 189.4315 203.9436 191.7229 188.6677 
     299      300      301      302      303      304      305      306 
181.0297 194.7780 187.1401 200.1246 188.6677 194.7780 193.2504 206.2350 
     307      308      309      310      311      312      313      314 
185.6125 202.4160 187.9039 199.3608 191.7229 196.3056 195.5418 210.0540 
     315      316      317      318      319      320      321      322 
177.9745 205.4712 197.0694 192.4867 190.9591 190.1953 192.8685 204.7074 
     323      324      325      326      327      328      329      330 
188.6677 202.4160 186.3763 192.8685 187.5220 197.0694 191.7229 198.5970 
     331      332      333      334      335      336      337      338 
187.9039 189.4315 186.3763 198.5970 194.7780 190.5772 197.0694 192.4867 
     339      340      341      342      343      344 
192.4867 197.8332 188.6677 194.3961 199.3608 194.3961 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a></a>pengmod<span class="sc">$</span>fit<span class="sc">$</span>residuals</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           1            2            3            5            6            7 
-13.01424280  -8.77803858   8.62371500   3.56853188  -2.48665124 -11.10475335 
           8            9           10           11           12           13 
-13.14446474   3.18663399 -11.65220061  -1.14008078 -13.25044702  -3.61248922 
          14           15           16           17           18           19 
 -3.77803858  -5.94358795  -8.25044702   5.56853188  -8.47117951  -3.52197867 
          20           21           22           23           24           25 
 -6.88840483 -14.66767234 -11.72285546  -5.77803858 -12.06942592 -14.77803858 
          26           27           28           29           30           31 
 -7.77803858  -7.95905968   1.38751078 -12.84869344 -17.06942592  -8.37628500 
          32           33           34           35           36           37 
-18.30563014   0.85991922 -12.30563014   7.47802133  -4.12460905  -7.06942592 
          38           39           40           41           42           43 
-10.95905968  -6.14008078 -23.76256685  -2.84869344  -1.30563014   1.91510234 
          44           45           46           47           48           49 
 -7.94358795   2.44269390 -16.99877107  -7.04957023  -3.17540821   0.56853188 
          50           51           52           53           54           55 
 -9.12460905  -4.19526390 -14.41599639   0.56853188   1.40298251   5.97028546 
          56           57           58           59           60           61 
 -2.25044702  -4.95905968  -1.77803858   0.73408124  -0.01424280   0.15130656 
          62           63           64           65           66           67 
 -8.94358795  -6.72285546  -6.59701749   3.73408124  -5.06942592   7.09612344 
          68           69           70           71           72           73 
-11.36081327   6.67889812  -6.70738373  -1.72285546  -6.30563014   5.04094032 
          74           75           76           77           78           79 
 -3.12460905  -3.25044702  -6.65220061  -2.25044702 -12.30563014  -3.95905968 
          80           81           82           83           84           85 
 -2.83322170   3.38751078 -12.52636263  -7.77803858  -7.88840483   3.09612344 
          86           87           88           89           90           91 
  3.04094032  -4.77803858  -1.19526390  -8.06942592  -1.72285546  11.04094032 
          92           93           94           95           96           97 
  2.58400361  -3.66767234 -18.70738373  -0.14008078   5.58400361  -3.25044702 
          98           99          100          101          102          103 
 -7.17979217  -3.02971454  -7.36081327  -1.63234491  -5.90826052  -0.70299977 
         104          105          106          107          108          109 
-11.65220061  11.58838757  -6.95905968   4.98575720  -6.30563014  -4.23059133 
         110          111          112          113          114          115 
-12.67205630   2.84006353 -15.99877107   7.38751078  -5.03409850  -5.30563014 
         116          117          118          119          120          121 
 -2.97891538   6.97028546   4.60385931   1.09612344   1.47802133   2.15130656 
         122          123          124          125          126          127 
  7.80473610 -13.43146812   6.07626775   2.67889812   1.16677830   4.24181711 
         128          129          130          131          132          133 
 -7.41599639   7.67889812  12.16677830   2.47802133   6.80473610   2.80473610 
         134          135          136          137          138          139 
 -6.08928162  -2.04957023  -6.30563014   5.76940867   2.54867619  -3.66767234 
         140          141          142          143          144          145 
 -8.65220061   4.33232766  -2.81336601   4.67889812  -3.63234491   9.44269390 
         146          147          148          149          150          151 
 -7.48665124 -11.65220061  -5.81336601   5.56853188  -1.01424280  -6.25044702 
         152          153          154          155          156          157 
  3.16677830   5.52882049   6.19772176   5.29261627  -5.80227824  -4.21950356 
         158          159          160          161          162          163 
  3.76502471   0.94604581   2.83567957   5.05641205  -0.40052465   6.23743315 
         164          165          166          167          168          169 
 -5.51089090   6.23743315 -13.09366558   9.11159517  -9.09366558   9.87539095 
         170          171          172          173          174          175 
-11.96782760  -1.05395419   3.54429222  -5.80227824   1.89086269   9.05641205 
         176          177          178          179          180          181 
  1.12706691   1.89086269   0.36327113  16.63918673  -8.03848246   3.00122893 
         182          183          184          185          186          187 
 -1.51089090   5.07188379   0.47363737  -6.87293309   0.85115130   4.59947535 
         188          189          190          191          192          193 
  0.78049644   0.65465847   2.07188379   4.82020783 -10.45570778  10.93057408 
         194          195          196          197          198          199 
  1.19772176   7.58400361   6.70984159   0.48910910   5.41845425   9.11159517 
         200          201          202          203          204          205 
  5.78049644  -1.63672887  -2.69191200  -0.81774997   2.30808800   6.05641205 
         206          207          208          209          210          211 
 11.89086269   5.41845425   6.12706691   5.58400361   6.89086269   3.29261627 
         212          213          214          215          216          217 
  2.48910910   7.11159517   3.30808800  10.05641205   7.96151754  10.47363737 
         218          219          220          221          222          223 
  6.19772176   6.23743315   3.67013020  11.47363737   1.48910910   6.70984159 
         224          225          226          227          228          229 
  7.89086269   6.36327113   0.83567957   7.47363737   4.67013020   2.00122893 
         230          231          232          233          234          235 
 -8.38505292   5.70984159  -4.62125714   4.61933104   1.01670066   3.09173948 
         236          237          238          239          240          241 
  5.54429222   2.70984159   5.72531332  11.00122893   0.30808800   0.80035214 
         242          243          244          245          246          247 
  8.48910910   5.65465847   8.78049644   2.70984159   0.96151754   3.18225003 
         248          249          250          251          252          253 
  9.83567957   4.03655636  10.80035214  -4.38066896   8.07188379   8.18225003 
         254          255          256          257          258          259 
  5.72531332   2.27276058   7.25290488   7.09173948  -5.74709512   1.47363737 
         260          261          262          263          264          265 
 -1.74709512   1.38312682 -11.74709512   2.89086269   1.37874286   5.23743315 
         266          267          268          269          270          271 
  9.25290488  13.43830994   3.90633442   5.80035214  -6.38505292   2.03655636 
         273          274          275          276          277          278 
  4.18225003  -2.56607402  -4.16432043  -6.21950356   1.80473610  -0.30563014 
         279          280          281          282          283          284 
  0.51334876  -2.57716179   3.36765509   0.93057408  -8.37628500   2.98575720 
         285          286          287          288          289          290 
 -5.12460905   4.74955298  -1.77803858  -0.39614069  -8.25044702   2.40298251 
         291          292          293          294          295          296 
 -1.34095757   2.40298251   9.85991922 -12.25044702   0.56853188  -8.94358795 
         297          298          299          300          301          302 
-10.72285546   2.33232766   5.97028546  -1.77803858   7.85991922  -3.12460905 
         303          304          305          306          307          308 
 11.33232766   5.22196142  -2.25044702  -1.23497529   1.38751078  -1.41599639 
         309          310          311          312          313          314 
 -0.90387656   3.63918673   3.27714454   2.69436986  -0.54183436  -0.05395419 
         315          316          317          318          319          320 
 14.02546859  -0.47117951  12.93057408  -5.48665124   5.04094032   5.80473610 
         321          322          323          324          325          326 
  3.13145087  -3.70738373   1.33232766   9.58400361   0.62371500   5.13145087 
         327          328          329          330          331          332 
 11.47802133   3.93057408   1.27714454   4.40298251  -0.90387656   7.56853188 
         333          334          335          336          337          338 
  4.62371500   4.40298251   7.22196142   3.42283821   8.93057408  -3.48665124 
         339          340          341          342          343          344 
  2.51334876   9.16677830  13.33232766  -1.39614069  10.63918673   3.60385931 </code></pre>
</div>
</div>
</section>
<section id="fitting-method-least-squares-regression" class="slide level2 smaller" data-background-color="aquamarine">
<h2>Fitting method: Least squares regression</h2>
<ul>
<li>The regression line shall minimize the sum of the squared residuals<br>
(or, identically, their mean).</li>
<li>Mathematically: The residual for case <span class="math inline">\(i\)</span> is <span class="math inline">\(e_i = \hat y_i - y_i\)</span>.</li>
<li>Now we want to minimize <span class="math inline">\(\sum_{i=1}^n e_i^2\)</span><br>
(or equivalently <span class="math inline">\(\frac{1}{n}\sum_{i=1}^n e_i^2\)</span> the <em>mean of squared errors</em>, which we will look at later).</li>
</ul>
</section>
<section id="visualization-of-residuals" class="slide level2 smaller scrollable" data-background-color="aquamarine">
<h2>Visualization of residuals</h2>
<p>The residuals are the gray lines between predicted values on the regression line and the actual values.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a></a>pengmod <span class="ot">&lt;-</span> </span>
<span id="cb40-2"><a></a>  <span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb40-3"><a></a>  <span class="fu">set_engine</span>(<span class="st">"lm"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb40-4"><a></a>  <span class="fu">fit</span>(flipper_length_mm <span class="sc">~</span> body_mass_g, <span class="at">data =</span> penguins)</span>
<span id="cb40-5"><a></a>penguins <span class="sc">|&gt;</span> <span class="fu">bind_cols</span>(<span class="fu">predict</span>(pengmod,penguins)) <span class="sc">|&gt;</span> </span>
<span id="cb40-6"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(body_mass_g, flipper_length_mm)) <span class="sc">+</span></span>
<span id="cb40-7"><a></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> body_mass_g, <span class="at">y =</span> flipper_length_mm, <span class="at">xend =</span> body_mass_g, <span class="at">yend =</span> .pred), <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb40-8"><a></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb40-9"><a></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>) <span class="sc">+</span> </span>
<span id="cb40-10"><a></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>.pred), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">alpha =</span>  <span class="fl">0.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="W07_files/figure-revealjs/unnamed-chunk-20-1.png" width="960" class="r-stretch"></section>
<section id="check-fitted-values-and-residuals" class="slide level2 smaller scrollable" data-background-color="aquamarine">
<h2>Check: Fitted values and Residuals</h2>
<p>Recall: <strong>Residual = Observed value - Predicted value</strong></p>
<p>The <em>Predicted values</em> are also called <em>Fitted values</em>. Hence:</p>
<p>Residuals + Fitted values = Observed values</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a></a>pengmod<span class="sc">$</span>fit<span class="sc">$</span>residuals <span class="sc">+</span> pengmod<span class="sc">$</span>fit<span class="sc">$</span>fitted.values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  1   2   3   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19  20  21 
181 186 195 193 190 181 195 193 190 186 180 182 191 198 185 195 197 184 194 174 
 22  23  24  25  26  27  28  29  30  31  32  33  34  35  36  37  38  39  40  41 
180 189 185 180 187 183 187 172 180 178 178 188 184 195 196 190 180 181 184 182 
 42  43  44  45  46  47  48  49  50  51  52  53  54  55  56  57  58  59  60  61 
195 186 196 185 190 182 179 190 191 186 188 190 200 187 191 186 193 181 194 185 
 62  63  64  65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80  81 
195 185 192 184 192 195 188 190 198 190 190 196 197 190 195 191 184 187 195 189 
 82  83  84  85  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100 101 
196 187 193 191 194 190 189 189 190 202 205 185 186 187 208 190 196 178 192 192 
102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 
203 183 190 193 184 199 190 181 197 198 191 193 197 191 196 188 199 189 189 187 
122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 
198 176 202 186 199 191 195 191 210 190 197 193 199 187 190 191 200 185 193 193 
142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 
187 188 190 192 185 190 184 195 193 187 201 211 230 210 218 215 210 211 219 209 
162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 
215 214 216 214 213 210 217 210 221 209 222 218 215 213 215 215 215 216 215 210 
182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 
220 222 209 207 230 220 220 213 219 208 208 208 225 210 216 222 217 210 225 213 
202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 
215 210 220 210 225 217 220 208 220 208 224 208 221 214 231 219 230 214 229 220 
222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 
223 216 221 221 217 216 230 209 220 215 223 212 221 212 224 212 228 218 218 212 
242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 
230 218 228 212 224 214 226 216 222 203 225 219 228 215 228 216 215 210 219 208 
262 263 264 265 266 267 268 269 270 271 273 274 275 276 277 278 279 280 281 282 
209 216 229 213 230 217 230 217 222 214 215 222 212 213 192 196 193 188 197 198 
283 284 285 286 287 288 289 290 291 292 293 294 295 296 297 298 299 300 301 302 
178 197 195 198 193 194 185 201 190 201 197 181 190 195 181 191 187 193 195 197 
303 304 305 306 307 308 309 310 311 312 313 314 315 316 317 318 319 320 321 322 
200 200 191 205 187 201 187 203 195 199 195 210 192 205 210 187 196 196 196 201 
323 324 325 326 327 328 329 330 331 332 333 334 335 336 337 338 339 340 341 342 
190 212 187 198 199 201 193 203 187 197 191 203 202 194 206 189 195 207 202 193 
343 344 
210 198 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a></a>penguins<span class="sc">$</span>flipper_length_mm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 181 186 195  NA 193 190 181 195 193 190 186 180 182 191 198 185 195 197
 [19] 184 194 174 180 189 185 180 187 183 187 172 180 178 178 188 184 195 196
 [37] 190 180 181 184 182 195 186 196 185 190 182 179 190 191 186 188 190 200
 [55] 187 191 186 193 181 194 185 195 185 192 184 192 195 188 190 198 190 190
 [73] 196 197 190 195 191 184 187 195 189 196 187 193 191 194 190 189 189 190
 [91] 202 205 185 186 187 208 190 196 178 192 192 203 183 190 193 184 199 190
[109] 181 197 198 191 193 197 191 196 188 199 189 189 187 198 176 202 186 199
[127] 191 195 191 210 190 197 193 199 187 190 191 200 185 193 193 187 188 190
[145] 192 185 190 184 195 193 187 201 211 230 210 218 215 210 211 219 209 215
[163] 214 216 214 213 210 217 210 221 209 222 218 215 213 215 215 215 216 215
[181] 210 220 222 209 207 230 220 220 213 219 208 208 208 225 210 216 222 217
[199] 210 225 213 215 210 220 210 225 217 220 208 220 208 224 208 221 214 231
[217] 219 230 214 229 220 223 216 221 221 217 216 230 209 220 215 223 212 221
[235] 212 224 212 228 218 218 212 230 218 228 212 224 214 226 216 222 203 225
[253] 219 228 215 228 216 215 210 219 208 209 216 229 213 230 217 230 217 222
[271] 214  NA 215 222 212 213 192 196 193 188 197 198 178 197 195 198 193 194
[289] 185 201 190 201 197 181 190 195 181 191 187 193 195 197 200 200 191 205
[307] 187 201 187 203 195 199 195 210 192 205 210 187 196 196 196 201 190 212
[325] 187 198 199 201 193 203 187 197 191 203 202 194 206 189 195 207 202 193
[343] 210 198</code></pre>
</div>
</div>
</section>
<section id="proporties-of-least-squares-regression" class="slide level2 smaller" data-background-color="aquamarine">
<h2>Proporties of least squares regression</h2>
<p>The regression lines goes through the point (<code>mean(x)</code>, <code>mean(y)</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a></a><span class="fu">mean</span>(penguins<span class="sc">$</span>body_mass_g, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4201.754</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a></a><span class="fu">mean</span>(penguins<span class="sc">$</span>flipper_length_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 200.9152</code></pre>
</div>
</div>

<img data-src="W07_files/figure-revealjs/unnamed-chunk-24-1.png" width="960" class="r-stretch"></section>
<section id="proporties-of-least-squares-regression-1" class="slide level2 smaller" data-background-color="aquamarine">
<h2>Proporties of least squares regression</h2>
<p>Residuals sum up to zero</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a></a>pengmod <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">|&gt;</span>  <span class="fu">set_engine</span>(<span class="st">"lm"</span>) <span class="sc">|&gt;</span> <span class="fu">fit</span>(flipper_length_mm <span class="sc">~</span> body_mass_g, <span class="at">data =</span> penguins)</span>
<span id="cb49-2"><a></a>pengmod<span class="sc">$</span>fit<span class="sc">$</span>residuals <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1.135758e-13</code></pre>
</div>
</div>
<div class="fragment">
<p>There is no correlation between residuals and the explanatory variable</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a></a><span class="fu">cor</span>(pengmod<span class="sc">$</span>fit<span class="sc">$</span>residuals, <span class="fu">na.omit</span>(penguins<span class="sc">$</span>body_mass_g))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1.083343e-16</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>The correlation of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> is the slope <span class="math inline">\(\beta_1\)</span> “corrected” by their standard deviations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a></a>correlation <span class="ot">&lt;-</span> <span class="fu">cor</span>(penguins<span class="sc">$</span>flipper_length_mm, penguins<span class="sc">$</span>body_mass_g, <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)</span>
<span id="cb53-2"><a></a>sd_flipper <span class="ot">&lt;-</span> <span class="fu">sd</span>(penguins<span class="sc">$</span>flipper_length_mm, <span class="at">na.rm =</span> T)</span>
<span id="cb53-3"><a></a>sd_mass <span class="ot">&lt;-</span> <span class="fu">sd</span>(penguins<span class="sc">$</span>body_mass_g, <span class="at">na.rm =</span> T)</span>
<span id="cb53-4"><a></a><span class="fu">c</span>(correlation, sd_flipper, sd_mass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]   0.8712018  14.0617137 801.9545357</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a></a>correlation <span class="sc">*</span> sd_flipper <span class="sc">/</span> sd_mass</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01527592</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a></a>pengmod<span class="sc">$</span>fit<span class="sc">$</span>coefficients</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> (Intercept)  body_mass_g 
136.72955927   0.01527592 </code></pre>
</div>
</div>
</div>
</section>
<section id="correlation-and-linear-regression" class="slide level2 smaller" data-background-color="aquamarine">
<h2>Correlation and linear regression</h2>
<p>When the two variables in the linear regression are standardized (standard scores)</p>
<ul>
<li>the intercept is zero</li>
<li>the coefficient coincides with the correlation</li>
</ul>
</section></section>
<section>
<section id="linear-models-and-dummy-variables" class="title-slide slide level1 center">
<h1>Linear Models and Dummy Variables</h1>

</section>
<section id="explanatory-variables-are-categorical" class="slide level2 smaller">
<h2>Explanatory variables are categorical</h2>
<p>Let’s try what happens with <code>species</code> as explanatory variable. Remember, we have three species: Adelie, Chinstrap, Gentoo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a></a><span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb59-2"><a></a>    <span class="fu">set_engine</span>(<span class="st">"lm"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb59-3"><a></a>    <span class="fu">fit</span>(flipper_length_mm <span class="sc">~</span> species, <span class="at">data =</span> penguins) <span class="sc">|&gt;</span> </span>
<span id="cb59-4"><a></a>    <span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  term             estimate std.error statistic   p.value
  &lt;chr&gt;               &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)        190.       0.540    351.   0        
2 speciesChinstrap     5.87     0.970      6.05 3.79e-  9
3 speciesGentoo       27.2      0.807     33.8  1.84e-110</code></pre>
</div>
</div>
<p>What happened?</p>
<div class="fragment">
<p>Two of the three species categories appear as variables now.</p>
<ul>
<li>Categorical variables are automatically encoded to <strong>dummy variables</strong></li>
<li>Each coefficient describes the expected difference between flipper length of that particular species compared to the baseline level</li>
<li>What is the baseline level? <span class="fragment"><span style="color:red;">The first category!</span> (Here alphabetically <code>"Adelie"</code>)</span></li>
</ul>
</div>
</section>
<section id="how-do-dummy-variables-look" class="slide level2 smaller">
<h2>How do dummy variables look?</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th>species</th>
<th>speciesChinstrap</th>
<th>speciesGentoo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Adelie</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>Adelie</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>Chinstrap</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<td>Gentoo</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="odd">
<td>Gentoo</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td>Gentoo</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="odd">
<td>Adelie</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>Chinstrap</td>
<td>1</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>Then the fitting of the linear model is as before using the zero-one variables.</p>
</section>
<section id="interpretation" class="slide level2 smaller" data-background-color="khaki">
<h2>Interpretation</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a></a><span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb61-2"><a></a>    <span class="fu">set_engine</span>(<span class="st">"lm"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb61-3"><a></a>    <span class="fu">fit</span>(flipper_length_mm <span class="sc">~</span> species, <span class="at">data =</span> penguins) <span class="sc">|&gt;</span> </span>
<span id="cb61-4"><a></a>    <span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  term             estimate std.error statistic   p.value
  &lt;chr&gt;               &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)        190.       0.540    351.   0        
2 speciesChinstrap     5.87     0.970      6.05 3.79e-  9
3 speciesGentoo       27.2      0.807     33.8  1.84e-110</code></pre>
</div>
</div>
<ul>
<li>Flipper length of the baseline species is the intercept.
<ul>
<li>Average flipper length of Adelie is 190 mm</li>
</ul></li>
<li>Flipper length of the two other species add their coefficient
<ul>
<li>Average flipper length of Chinstrap is 190 + 5.87 mm</li>
<li>Average flipper length of Gentoo is 190 + 27.2 mm</li>
</ul></li>
</ul>
</section>
<section id="compare-to-a-visualization" class="slide level2 smaller">
<h2>Compare to a visualization</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  term             estimate std.error statistic   p.value
  &lt;chr&gt;               &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)        190.       0.540    351.   0        
2 speciesChinstrap     5.87     0.970      6.05 3.79e-  9
3 speciesGentoo       27.2      0.807     33.8  1.84e-110</code></pre>
</div>
</div>

<img data-src="W07_files/figure-revealjs/unnamed-chunk-31-1.png" width="288" class="r-stretch"><p>The red dots are the average values for species.</p>
</section></section>
<section>
<section id="linear-models-and-r-squared" class="title-slide slide level1 center">
<h1>Linear models and R-squared</h1>

</section>
<section id="quality-of-different-linear-models" class="slide level2 smaller">
<h2>Quality of different linear models?</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a></a><span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> <span class="fu">set_engine</span>(<span class="st">"lm"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb64-2"><a></a>    <span class="fu">fit</span>(flipper_length_mm <span class="sc">~</span> body_mass_g, <span class="at">data =</span> penguins) <span class="sc">|&gt;</span> </span>
<span id="cb64-3"><a></a> <span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term        estimate std.error statistic   p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept) 137.      2.00          68.5 5.71e-201
2 body_mass_g   0.0153  0.000467      32.7 4.37e-107</code></pre>
</div>
</div>
<p>average <code>flipper_length_mm</code> <span class="math inline">\(= 137 + 0.0153\cdot\)</span> <code>body_mass_g</code></p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a></a><span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> <span class="fu">set_engine</span>(<span class="st">"lm"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb66-2"><a></a>    <span class="fu">fit</span>(bill_depth_mm <span class="sc">~</span> bill_length_mm, <span class="at">data =</span> penguins) <span class="sc">|&gt;</span> </span>
<span id="cb66-3"><a></a> <span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term           estimate std.error statistic  p.value
  &lt;chr&gt;             &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)     20.9       0.844      24.7  4.72e-78
2 bill_length_mm  -0.0850    0.0191     -4.46 1.12e- 5</code></pre>
</div>
</div>
<p>average <code>bill_depth_mm</code> <span class="math inline">\(= 20.9 -0.085\cdot\)</span> <code>bill_length_mm</code></p>
</div>
<div class="fragment">
<p><strong>Technical:</strong> The idea of the <code>tidy()</code> function is to turn an object into a tidy tibble. Here, it extracts the coefficients of the linear model (and more statistical information).</p>
</div>
</section>
<section id="r-squared-of-a-fitted-model" class="slide level2 smaller" data-background-color="aquamarine">
<h2>R-squared of a fitted model</h2>
<p><span class="math inline">\(R^2\)</span> is the percentage of variability in the response explained by the regression model.</p>
<p>R-squared is also called <strong>coefficient of determination</strong>.</p>
<p><strong>Definition</strong>:</p>
<p><span class="math inline">\(R^2 = 1 - \frac{SS_\text{res}}{SS_\text{tot}}\)</span></p>
<p>where <span class="math inline">\(SS_\text{res} = \sum_i(y_i - f_i)^2 = \sum_i e_i^2\)</span> is the <em>sum of the squared residuals</em>, and<br>
<span class="math inline">\(SS_\text{tot} = \sum_i(y_i - \bar y)^2\)</span> the <em>total sum of squares</em> which is proportional to the variance of <span class="math inline">\(y\)</span>. (<span class="math inline">\(\bar y\)</span> is the mean of <span class="math inline">\(y\)</span>.)</p>

<img data-src="https://upload.wikimedia.org/wikipedia/commons/8/86/Coefficient_of_Determination.svg" class="r-stretch"></section>
<section id="linear-model-r-squared" class="slide level2 smaller">
<h2>Linear model R-squared</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a></a><span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> <span class="fu">set_engine</span>(<span class="st">"lm"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb68-2"><a></a> <span class="fu">fit</span>(flipper_length_mm <span class="sc">~</span> body_mass_g, <span class="at">data =</span> penguins) <span class="sc">|&gt;</span></span>
<span id="cb68-3"><a></a> <span class="fu">glance</span>()  <span class="co"># glance shows summary statistics of model fit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 12
  r.squared adj.r.squared sigma statistic   p.value    df logLik   AIC   BIC
      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0.759         0.758  6.91     1071. 4.37e-107     1 -1146. 2297. 2309.
# ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
</div>
</div>
<p><strong>Interpretation R-squared?</strong> <span class="fragment">75.9% of the variance of flipper length can be explained by a linear relation with body mass.</span></p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a></a><span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> <span class="fu">set_engine</span>(<span class="st">"lm"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb70-2"><a></a>    <span class="fu">fit</span>(bill_depth_mm <span class="sc">~</span> bill_length_mm, <span class="at">data =</span> penguins) <span class="sc">|&gt;</span> </span>
<span id="cb70-3"><a></a> <span class="fu">glance</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 12
  r.squared adj.r.squared sigma statistic   p.value    df logLik   AIC   BIC
      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1    0.0552        0.0525  1.92      19.9 0.0000112     1  -708. 1422. 1433.
# ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
</div>
</div>
<p>5.52% of the variance of bill depth can be explained by a linear relation with bill length.</p>
</div>
<div class="fragment">
<p><strong>Technical:</strong> The idea of the <code>glance()</code> function is to construct a single row summary “glance” of a model, fit, or other object.</p>
</div>
</section>
<section id="r-squared-and-correlation" class="slide level2 smaller">
<h2>R-squared and correlation</h2>
<p>For a linear model with one predictor, the square of the correlation coefficient is the same as the R-squared of the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a></a><span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> <span class="fu">set_engine</span>(<span class="st">"lm"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb72-2"><a></a>    <span class="fu">fit</span>(flipper_length_mm <span class="sc">~</span> body_mass_g, <span class="at">data =</span> penguins) <span class="sc">|&gt;</span> </span>
<span id="cb72-3"><a></a> <span class="fu">glance</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 12
  r.squared adj.r.squared sigma statistic   p.value    df logLik   AIC   BIC
      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0.759         0.758  6.91     1071. 4.37e-107     1 -1146. 2297. 2309.
# ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a></a><span class="fu">cor</span>(penguins<span class="sc">$</span>flipper_length_mm, penguins<span class="sc">$</span>body_mass_g, <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8712018</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a></a><span class="fu">cor</span>(penguins<span class="sc">$</span>flipper_length_mm, penguins<span class="sc">$</span>body_mass_g, <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)<span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7589925</code></pre>
</div>
</div>
<div class="fragment">
<p>Hence, the name <span class="math inline">\(R^2\)</span>!</p>
</div>
</section></section>
<section>
<section id="linear-models-with-more-predictors" class="title-slide slide level1 center">
<h1>Linear models with more predictors</h1>

</section>
<section id="more-predictors-coefficients" class="slide level2 smaller">
<h2>More predictors: Coefficients</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a></a><span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> <span class="fu">set_engine</span>(<span class="st">"lm"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb78-2"><a></a> <span class="fu">fit</span>(flipper_length_mm <span class="sc">~</span> body_mass_g, <span class="at">data =</span> penguins) <span class="sc">|&gt;</span> </span>
<span id="cb78-3"><a></a> <span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term        estimate std.error statistic   p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept) 137.      2.00          68.5 5.71e-201
2 body_mass_g   0.0153  0.000467      32.7 4.37e-107</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a></a><span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> <span class="fu">set_engine</span>(<span class="st">"lm"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb80-2"><a></a> <span class="fu">fit</span>(flipper_length_mm <span class="sc">~</span> body_mass_g <span class="sc">+</span> bill_length_mm, <span class="at">data =</span> penguins) <span class="sc">|&gt;</span> </span>
<span id="cb80-3"><a></a> <span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  term           estimate std.error statistic   p.value
  &lt;chr&gt;             &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)    122.      2.86         42.7  1.70e-138
2 body_mass_g      0.0131  0.000545     23.9  7.56e- 75
3 bill_length_mm   0.549   0.0801        6.86 3.31e- 11</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a></a><span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> <span class="fu">set_engine</span>(<span class="st">"lm"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb82-2"><a></a> <span class="fu">fit</span>(flipper_length_mm <span class="sc">~</span> body_mass_g <span class="sc">+</span> bill_length_mm <span class="sc">+</span> bill_depth_mm, <span class="at">data =</span> penguins) <span class="sc">|&gt;</span> </span>
<span id="cb82-3"><a></a> <span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
  term           estimate std.error statistic   p.value
  &lt;chr&gt;             &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)    158.      4.63         34.1  1.80e-111
2 body_mass_g      0.0109  0.000538     20.3  1.93e- 60
3 bill_length_mm   0.592   0.0717        8.26 3.42e- 15
4 bill_depth_mm   -1.68    0.181        -9.29 1.99e- 18</code></pre>
</div>
</div>
</section>
<section id="more-predictors-glance-r-squared" class="slide level2 smaller">
<h2>More predictors: <code>glance</code> R-squared</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a></a><span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> <span class="fu">set_engine</span>(<span class="st">"lm"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb84-2"><a></a> <span class="fu">fit</span>(flipper_length_mm <span class="sc">~</span> body_mass_g, <span class="at">data =</span> penguins) <span class="sc">|&gt;</span> </span>
<span id="cb84-3"><a></a> <span class="fu">glance</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 12
  r.squared adj.r.squared sigma statistic   p.value    df logLik   AIC   BIC
      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0.759         0.758  6.91     1071. 4.37e-107     1 -1146. 2297. 2309.
# ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a></a><span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> <span class="fu">set_engine</span>(<span class="st">"lm"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb86-2"><a></a> <span class="fu">fit</span>(flipper_length_mm <span class="sc">~</span> body_mass_g <span class="sc">+</span> bill_length_mm, <span class="at">data =</span> penguins) <span class="sc">|&gt;</span> </span>
<span id="cb86-3"><a></a> <span class="fu">glance</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 12
  r.squared adj.r.squared sigma statistic   p.value    df logLik   AIC   BIC
      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0.788         0.787  6.49      631. 4.88e-115     2 -1123. 2255. 2270.
# ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a></a><span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> <span class="fu">set_engine</span>(<span class="st">"lm"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb88-2"><a></a> <span class="fu">fit</span>(flipper_length_mm <span class="sc">~</span> body_mass_g <span class="sc">+</span> bill_length_mm <span class="sc">+</span> bill_depth_mm, <span class="at">data =</span> penguins) <span class="sc">|&gt;</span> </span>
<span id="cb88-3"><a></a> <span class="fu">glance</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 12
  r.squared adj.r.squared sigma statistic   p.value    df logLik   AIC   BIC
      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0.831         0.830  5.80      556. 2.99e-130     3 -1084. 2179. 2198.
# ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
</div>
</div>
</section>
<section id="more-predictors-equations" class="slide level2 smaller">
<h2>More predictors: Equations</h2>
<p>average <code>flipper_length_mm</code> <span class="math inline">\(= 137 + 0.0153\cdot\)</span> <code>body_mass_g</code><br>
75.9% explained variance</p>
<p>average <code>flipper_length_mm</code> <span class="math inline">\(= 122 + 0.0131\cdot\)</span> <code>body_mass_g</code> <span class="math inline">\(+ 0.549\cdot\)</span> <code>bill_length_mm</code><br>
78.8% explained variance</p>
<p>average <code>flipper_length_mm</code> <span class="math inline">\(= 158 + 0.0109\cdot\)</span> <code>body_mass_g</code> <span class="math inline">\(+ 0.592\cdot\)</span> <code>bill_length_mm</code> <span class="math inline">\(- 1.68\cdot\)</span> <code>bill_length_mm</code><br>
83.1% explained variance</p>
</section></section>
<section>
<section id="nonlinear-models" class="title-slide slide level1 center">
<h1>Nonlinear Models</h1>

</section>
<section id="when-a-linear-model-is-bad" class="slide level2">
<h2>When a linear model is bad</h2>
<p>Example: Total corona cases in Germany in the first wave 2020.</p>

<img data-src="W07_files/figure-revealjs/unnamed-chunk-45-1.png" width="960" class="r-stretch"></section>
<section id="log-transformation" class="slide level2 smaller">
<h2><span class="math inline">\(\log\)</span> transformation</h2>
<p>Instead of <code>Cumulative_cases</code> we look at <span class="math inline">\(\log(\)</span><code>Cumulative_cases</code><span class="math inline">\()\)</span></p>

<img data-src="W07_files/figure-revealjs/unnamed-chunk-46-1.png" width="960" class="r-stretch"><p>Almost perfect fit of the linear model: <span class="math inline">\(\log(y)=\log(\beta_0) + \beta_1\cdot x\)</span><br>
(<span class="math inline">\(y=\)</span> <code>Cumulative cases</code>, <span class="math inline">\(x=\)</span> Days)</p>
<div class="fragment">
<p>Exponentiation gives the model: <span class="math inline">\(y=\beta_0 e^{\beta_1\cdot x}\)</span><br>
(Check <span class="math inline">\(e^{\log(\beta_0) + \beta_1\cdot x} = e^{\log(\beta_0)} e^{\beta_1\cdot x} = \beta_0 e^{\beta_1\cdot x}\)</span>)</p>
</div>
</section>
<section id="exponential-growth" class="slide level2 smaller">
<h2>Exponential growth!</h2>
<p><span style="color:red;"><span class="math inline">\(y=\beta_0 e^{\beta_1\cdot x}\)</span></span><br>
For comparison: Logistic function <span style="color:blue;"><span class="math inline">\(y = \frac{N \beta_0 e^{\beta_1\cdot x}}{N + \beta_0 e^{\beta_1\cdot x}}\)</span></span> for <span class="math inline">\(N=200000\)</span></p>

<img data-src="W07_files/figure-revealjs/unnamed-chunk-47-1.png" width="960" class="r-stretch"><p>Logistic growth (as in the SI model) mimicks exponential growth initially.</p>
</section>
<section id="log-transformation-1" class="slide level2 smaller">
<h2><span class="math inline">\(\log\)</span> transformation</h2>

<img data-src="W07_files/figure-revealjs/unnamed-chunk-48-1.png" width="960" class="r-stretch"><p>An important difference of <code>log10(Cumulative_cases) ~ Date_Reported</code> to the penguin model <code>flipper_length_mm ~ body_mass_g</code>? ?</p>
<div class="fragment">
<ul>
<li><span class="math inline">\(x\)</span> has an ordered structure and no duplicates</li>
</ul>
<p>The fit looks so good. Why?</p>
</div>
<div class="fragment">
<p>Because there is a <em>mechanistic explanation</em> behind: The SI model.</p>
</div>
</section>
<section id="however-it-works-only-in-a-certain-range" class="slide level2 smaller">
<h2>However, it works only in a certain range</h2>

<img data-src="W07_files/figure-revealjs/unnamed-chunk-49-1.png" width="960" class="r-stretch"></section>
<section id="however-it-works-only-in-a-certain-range-log-scale-on-y" class="slide level2 smaller">
<h2>However, it works only in a certain range (log scale on y)</h2>



<img data-src="W07_files/figure-revealjs/unnamed-chunk-50-1.png" width="960" class="r-stretch"></section></section>

    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="img/ConstructorUniversity.png" class="slide-logo"></p>
<div class="footer footer-default">
<p>MDSSB-DSCO-02: Data Science Concepts</p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': true,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: true,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp("https:\/\/CU-F25-MDSSB-01-Concepts-Tools\.github\.io\/Website\/");
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>