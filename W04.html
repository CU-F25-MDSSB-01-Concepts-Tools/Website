<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jan Lorenz">

<title>W#04: Relational Data, Math: Sets and Functions, Programming Functions ‚Äì Data Science Concepts / Data Science Tools</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-d90c30c96bad360bae691b5c26d18f86.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked nav-fixed slimcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Data Science Concepts / Data Science Tools</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" aria-current="page"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">W#04: Relational Data, Math: Sets and Functions, Programming Functions</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Syllabus</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./schedule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Schedule</strong></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./late.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Onboarding Late-arriving</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./homework.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework Projects</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./final.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Final Project</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./help.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Help Project Work</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./literature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Literature</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#preliminaries" id="toc-preliminaries" class="nav-link active" data-scroll-target="#preliminaries"><span class="header-section-number">0.1</span> Preliminaries</a></li>
  <li><a href="#strings-and-special-values" id="toc-strings-and-special-values" class="nav-link" data-scroll-target="#strings-and-special-values"><span class="header-section-number">1</span> Strings and Special Values</a>
  <ul class="collapse">
  <li><a href="#string-modification" id="toc-string-modification" class="nav-link" data-scroll-target="#string-modification"><span class="header-section-number">1.1</span> String modification</a></li>
  <li><a href="#string-wrangling-with-variable-names" id="toc-string-wrangling-with-variable-names" class="nav-link" data-scroll-target="#string-wrangling-with-variable-names"><span class="header-section-number">1.2</span> String wrangling with variable names</a></li>
  <li><a href="#use-word" id="toc-use-word" class="nav-link" data-scroll-target="#use-word"><span class="header-section-number">1.3</span> Use <code>word</code></a></li>
  <li><a href="#string-detection-regular-expressions" id="toc-string-detection-regular-expressions" class="nav-link" data-scroll-target="#string-detection-regular-expressions"><span class="header-section-number">1.4</span> String Detection / Regular Expressions</a></li>
  <li><a href="#regular-expressions" id="toc-regular-expressions" class="nav-link" data-scroll-target="#regular-expressions"><span class="header-section-number">1.5</span> Regular Expressions</a></li>
  <li><a href="#special-values" id="toc-special-values" class="nav-link" data-scroll-target="#special-values"><span class="header-section-number">1.6</span> Special values</a></li>
  <li><a href="#nas" id="toc-nas" class="nav-link" data-scroll-target="#nas"><span class="header-section-number">1.7</span> <code>NA</code>s</a></li>
  <li><a href="#nas-in-logical-operations" id="toc-nas-in-logical-operations" class="nav-link" data-scroll-target="#nas-in-logical-operations"><span class="header-section-number">1.8</span> <code>NA</code>s in logical operations</a></li>
  <li><a href="#null-is-the-null-object" id="toc-null-is-the-null-object" class="nav-link" data-scroll-target="#null-is-the-null-object"><span class="header-section-number">1.9</span> <code>NULL</code> is the null object</a></li>
  </ul></li>
  <li><a href="#relational-data---joining" id="toc-relational-data---joining" class="nav-link" data-scroll-target="#relational-data---joining"><span class="header-section-number">2</span> Relational Data - Joining</a>
  <ul class="collapse">
  <li><a href="#working-with-more-dataframes" id="toc-working-with-more-dataframes" class="nav-link" data-scroll-target="#working-with-more-dataframes"><span class="header-section-number">2.1</span> Working with more dataframes</a></li>
  <li><a href="#data-women-in-science" id="toc-data-women-in-science" class="nav-link" data-scroll-target="#data-women-in-science"><span class="header-section-number">2.2</span> Data: Women in science</a></li>
  <li><a href="#we-want-this-dataframe" id="toc-we-want-this-dataframe" class="nav-link" data-scroll-target="#we-want-this-dataframe"><span class="header-section-number">2.3</span> We want this dataframe</a></li>
  <li><a href="#joining-dataframes" id="toc-joining-dataframes" class="nav-link" data-scroll-target="#joining-dataframes"><span class="header-section-number">2.4</span> Joining dataframes</a></li>
  <li><a href="#simple-setup-for-x-and-y" id="toc-simple-setup-for-x-and-y" class="nav-link" data-scroll-target="#simple-setup-for-x-and-y"><span class="header-section-number">2.5</span> Simple setup for <code>x</code> and <code>y</code></a></li>
  <li><a href="#left_join" id="toc-left_join" class="nav-link" data-scroll-target="#left_join"><span class="header-section-number">2.6</span> <code>left_join()</code></a></li>
  <li><a href="#right_join" id="toc-right_join" class="nav-link" data-scroll-target="#right_join"><span class="header-section-number">2.7</span> <code>right_join()</code></a></li>
  <li><a href="#full_join" id="toc-full_join" class="nav-link" data-scroll-target="#full_join"><span class="header-section-number">2.8</span> <code>full_join()</code></a></li>
  <li><a href="#inner_join" id="toc-inner_join" class="nav-link" data-scroll-target="#inner_join"><span class="header-section-number">2.9</span> <code>inner_join()</code></a></li>
  <li><a href="#women-in-science" id="toc-women-in-science" class="nav-link" data-scroll-target="#women-in-science"><span class="header-section-number">2.10</span> Women in science</a></li>
  <li><a href="#keys" id="toc-keys" class="nav-link" data-scroll-target="#keys"><span class="header-section-number">2.11</span> Keys</a></li>
  <li><a href="#how-can-we-check" id="toc-how-can-we-check" class="nav-link" data-scroll-target="#how-can-we-check"><span class="header-section-number">2.12</span> How can we check?</a></li>
  <li><a href="#terminology-primary-and-foreign-keys" id="toc-terminology-primary-and-foreign-keys" class="nav-link" data-scroll-target="#terminology-primary-and-foreign-keys"><span class="header-section-number">2.13</span> Terminology: Primary and foreign keys</a></li>
  <li><a href="#joining-when-key-names-differ" id="toc-joining-when-key-names-differ" class="nav-link" data-scroll-target="#joining-when-key-names-differ"><span class="header-section-number">2.14</span> Joining when key names differ?</a></li>
  <li><a href="#left_join-is-essentially-right_join-with-switched-dataframes" id="toc-left_join-is-essentially-right_join-with-switched-dataframes" class="nav-link" data-scroll-target="#left_join-is-essentially-right_join-with-switched-dataframes"><span class="header-section-number">2.15</span> <code>left_join</code> is <em>essentially</em> <code>right_join</code> with switched dataframes</a></li>
  <li><a href="#left_join-with-reversed-dataframes" id="toc-left_join-with-reversed-dataframes" class="nav-link" data-scroll-target="#left_join-with-reversed-dataframes"><span class="header-section-number">2.16</span> <code>left_join</code> with reversed dataframes</a></li>
  </ul></li>
  <li><a href="#math-sets-and-vectors" id="toc-math-sets-and-vectors" class="nav-link" data-scroll-target="#math-sets-and-vectors"><span class="header-section-number">3</span> Math: Sets and vectors</a>
  <ul class="collapse">
  <li><a href="#definition-sets-and-vectors" id="toc-definition-sets-and-vectors" class="nav-link" data-scroll-target="#definition-sets-and-vectors"><span class="header-section-number">3.1</span> Definition: Sets and vectors</a></li>
  <li><a href="#math-sets-and-vectors-1" id="toc-math-sets-and-vectors-1" class="nav-link" data-scroll-target="#math-sets-and-vectors-1"><span class="header-section-number">3.2</span> Math: Sets and vectors</a></li>
  <li><a href="#math-set-operations" id="toc-math-set-operations" class="nav-link" data-scroll-target="#math-set-operations"><span class="header-section-number">3.3</span> Math: Set operations</a></li>
  <li><a href="#set-operations-in-r" id="toc-set-operations-in-r" class="nav-link" data-scroll-target="#set-operations-in-r"><span class="header-section-number">3.4</span> Set operations in R</a></li>
  <li><a href="#sets-take-away" id="toc-sets-take-away" class="nav-link" data-scroll-target="#sets-take-away"><span class="header-section-number">3.5</span> Sets: Take-away</a></li>
  </ul></li>
  <li><a href="#math-functions" id="toc-math-functions" class="nav-link" data-scroll-target="#math-functions"><span class="header-section-number">4</span> Math: Functions</a>
  <ul class="collapse">
  <li><a href="#functions-mathematically" id="toc-functions-mathematically" class="nav-link" data-scroll-target="#functions-mathematically"><span class="header-section-number">4.1</span> Functions mathematically</a></li>
  <li><a href="#conventions-in-mathematical-text" id="toc-conventions-in-mathematical-text" class="nav-link" data-scroll-target="#conventions-in-mathematical-text"><span class="header-section-number">4.2</span> Conventions in mathematical text</a></li>
  <li><a href="#is-this-a-mathematical-function" id="toc-is-this-a-mathematical-function" class="nav-link" data-scroll-target="#is-this-a-mathematical-function"><span class="header-section-number">4.3</span> Is this a mathematical function?</a></li>
  <li><a href="#is-this-a-mathematical-function-1" id="toc-is-this-a-mathematical-function-1" class="nav-link" data-scroll-target="#is-this-a-mathematical-function-1"><span class="header-section-number">4.4</span> Is this a mathematical function?</a></li>
  </ul></li>
  <li><a href="#functions-graphs-shift-and-scale-polynomial-vs.-exponential" id="toc-functions-graphs-shift-and-scale-polynomial-vs.-exponential" class="nav-link" data-scroll-target="#functions-graphs-shift-and-scale-polynomial-vs.-exponential"><span class="header-section-number">5</span> Functions: Graphs, Shift and Scale, Polynomial vs.&nbsp;Exponential</a>
  <ul class="collapse">
  <li><a href="#graphs-of-functions" id="toc-graphs-of-functions" class="nav-link" data-scroll-target="#graphs-of-functions"><span class="header-section-number">5.1</span> Graphs of functions</a></li>
  <li><a href="#some-functions-f-mathbbr-to-mathbbr" id="toc-some-functions-f-mathbbr-to-mathbbr" class="nav-link" data-scroll-target="#some-functions-f-mathbbr-to-mathbbr"><span class="header-section-number">5.2</span> Some functions <span class="math inline">\(f: \mathbb{R} \to \mathbb{R}\)</span></a></li>
  <li><a href="#shifts-and-scales" id="toc-shifts-and-scales" class="nav-link" data-scroll-target="#shifts-and-scales"><span class="header-section-number">5.3</span> Shifts and scales</a></li>
  <li><a href="#math-polynomials-and-exponentials" id="toc-math-polynomials-and-exponentials" class="nav-link" data-scroll-target="#math-polynomials-and-exponentials"><span class="header-section-number">5.4</span> Math: Polynomials and exponentials</a></li>
  </ul></li>
  <li><a href="#functions-in-programming-to-programming-function" id="toc-functions-in-programming-to-programming-function" class="nav-link" data-scroll-target="#functions-in-programming-to-programming-function"><span class="header-section-number">6</span> Functions in Programming <span class="math inline">\(\to\)</span> Programming Function</a>
  <ul class="collapse">
  <li><a href="#input-to-output" id="toc-input-to-output" class="nav-link" data-scroll-target="#input-to-output"><span class="header-section-number">6.1</span> Input <span class="math inline">\(\to\)</span> output</a></li>
  <li><a href="#function-as-objects-in-r" id="toc-function-as-objects-in-r" class="nav-link" data-scroll-target="#function-as-objects-in-r"><span class="header-section-number">6.2</span> Function as objects in R</a></li>
  <li><a href="#define-your-own-functions-in-r" id="toc-define-your-own-functions-in-r" class="nav-link" data-scroll-target="#define-your-own-functions-in-r"><span class="header-section-number">6.3</span> Define your own functions! (in R)</a></li>
  <li><a href="#flexibility-of-inputs-and-outputs" id="toc-flexibility-of-inputs-and-outputs" class="nav-link" data-scroll-target="#flexibility-of-inputs-and-outputs"><span class="header-section-number">6.4</span> Flexibility of inputs and outputs</a></li>
  </ul></li>
  <li><a href="#think-and-program-vectorized" id="toc-think-and-program-vectorized" class="nav-link" data-scroll-target="#think-and-program-vectorized"><span class="header-section-number">7</span> Think and program vectorized!</a>
  <ul class="collapse">
  <li><a href="#vectorized-functions" id="toc-vectorized-functions" class="nav-link" data-scroll-target="#vectorized-functions"><span class="header-section-number">7.1</span> Vectorized functions</a></li>
  <li><a href="#recall-vector-creation-functions" id="toc-recall-vector-creation-functions" class="nav-link" data-scroll-target="#recall-vector-creation-functions"><span class="header-section-number">7.2</span> Recall: Vector creation functions</a></li>
  <li><a href="#plotting-and-transformation" id="toc-plotting-and-transformation" class="nav-link" data-scroll-target="#plotting-and-transformation"><span class="header-section-number">7.3</span> Plotting and transformation</a></li>
  <li><a href="#conveniently-ggploting-functions" id="toc-conveniently-ggploting-functions" class="nav-link" data-scroll-target="#conveniently-ggploting-functions"><span class="header-section-number">7.4</span> Conveniently <code>ggplot</code>ing functions</a></li>
  </ul></li>
  <li><a href="#conditional-statements-if-and-iteration-map" id="toc-conditional-statements-if-and-iteration-map" class="nav-link" data-scroll-target="#conditional-statements-if-and-iteration-map"><span class="header-section-number">8</span> Conditional Statements (<code>if</code>) and Iteration (<code>map</code>)</a>
  <ul class="collapse">
  <li><a href="#conditional-statements" id="toc-conditional-statements" class="nav-link" data-scroll-target="#conditional-statements"><span class="header-section-number">8.1</span> Conditional statements</a></li>
  <li><a href="#vectorized-operations-with-map" id="toc-vectorized-operations-with-map" class="nav-link" data-scroll-target="#vectorized-operations-with-map"><span class="header-section-number">8.2</span> Vectorized operations with <code>map</code></a></li>
  <li><a href="#reduce" id="toc-reduce" class="nav-link" data-scroll-target="#reduce"><span class="header-section-number">8.3</span> <code>reduce</code></a></li>
  <li><a href="#map-and-reduce" id="toc-map-and-reduce" class="nav-link" data-scroll-target="#map-and-reduce"><span class="header-section-number">8.4</span> <code>map</code> and <code>reduce</code></a></li>
  <li><a href="#function-programming-take-away" id="toc-function-programming-take-away" class="nav-link" data-scroll-target="#function-programming-take-away"><span class="header-section-number">8.5</span> Function programming: Take away</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="W04.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">W#04: Relational Data, Math: Sets and Functions, Programming Functions</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jan Lorenz </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="preliminaries" class="level2 smaller page-columns page-full" data-number="0.1">
<h2 class="smaller anchored" data-number="0.1" data-anchor-id="preliminaries"><span class="header-section-number">0.1</span> Preliminaries</h2>
<p>In this lectures we will use these packages and datasets. You need to do this code in the Console to download data and play with some of the code in this lecture.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nycflights13)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(<span class="st">"data/hotels.csv"</span>)) {</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download.file</span>(<span class="at">url =</span> <span class="st">"https://raw.githubusercontent.com/rstudio-education/datascience-box/main/course-materials/_slides/u2-d06-grammar-wrangle/data/hotels.csv"</span>, </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">destfile =</span> <span class="st">"data/hotels.csv"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(<span class="st">"data/professions.csv"</span>)) {</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download.file</span>(<span class="at">url =</span> <span class="st">"https://raw.githubusercontent.com/rstudio-education/datascience-box/main/course-materials/_slides/u2-d08-multi-df/data/professions.csv"</span>, </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">destfile =</span> <span class="st">"data/professions.csv"</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(<span class="st">"data/dates.csv"</span>)) {</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download.file</span>(<span class="at">url =</span> <span class="st">"https://raw.githubusercontent.com/rstudio-education/datascience-box/main/course-materials/_slides/u2-d08-multi-df/data/dates.csv"</span>, </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">destfile =</span> <span class="st">"data/dates.csv"</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(<span class="st">"data/works.csv"</span>)) {</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download.file</span>(<span class="at">url =</span> <span class="st">"https://raw.githubusercontent.com/rstudio-education/datascience-box/main/course-materials/_slides/u2-d08-multi-df/data/works.csv"</span>, </span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">destfile =</span> <span class="st">"data/qorks.csv"</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<div class="no-row-height column-margin column-container"><div class="margin-aside">
<p>Tip: Run the script in an R-project and have a folder <code>data/</code> in it such that the local path works!</p>
</div></div></section>
<section id="strings-and-special-values" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Strings and Special Values</h1>
<section id="string-modification" class="level2 smaller" data-number="1.1">
<h2 class="smaller anchored" data-number="1.1" data-anchor-id="string-modification"><span class="header-section-number">1.1</span> String modification</h2>
<p>We modify strings with the <a href="https://stringr.tidyverse.org/"><code>stringr</code></a> package from the tidyverse core. All functions from <code>stringr</code> start with <code>str_</code>.</p>
<p>Very few examples:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">"x"</span>,<span class="st">"y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "x" "y"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_c</span>(<span class="st">"x"</span>,<span class="st">"y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "xy"</code></pre>
</div>
</div>
<p>. . .</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_c</span>(<span class="st">"x"</span>,<span class="st">"y"</span>,<span class="st">"z"</span>, <span class="at">sep=</span><span class="st">","</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "x,y,z"</code></pre>
</div>
</div>
<p>. . .</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">c</span>(<span class="st">"x"</span>,<span class="st">"y"</span>,<span class="st">"z"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_length</span>(<span class="fu">c</span>(<span class="st">"x"</span>,<span class="st">"y"</span>,<span class="st">"z"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 1 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_length</span>(<span class="fu">c</span>(<span class="st">"This is a string."</span>,<span class="st">"z"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 17  1</code></pre>
</div>
</div>
</section>
<section id="string-wrangling-with-variable-names" class="level2 smaller" data-number="1.2">
<h2 class="smaller anchored" data-number="1.2" data-anchor-id="string-wrangling-with-variable-names"><span class="header-section-number">1.2</span> String wrangling with variable names</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Name =</span> <span class="fu">c</span>(<span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"C"</span>), <span class="at">Age_2020 =</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>), <span class="at">Age_2021 =</span> <span class="fu">c</span>(<span class="dv">21</span>,<span class="dv">31</span>,<span class="dv">41</span>), <span class="at">Age_2022 =</span> <span class="fu">c</span>(<span class="dv">22</span>,<span class="dv">32</span>,<span class="dv">42</span>))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 √ó 4
  Name  Age_2020 Age_2021 Age_2022
  &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1 A           20       21       22
2 B           30       31       32
3 C           40       41       42</code></pre>
</div>
</div>
<p>We tidy that data set by creating a year variable.</p>
<p>. . .</p>
<div class="cell" data-output-location="fragment">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> <span class="fu">pivot_longer</span>(<span class="fu">c</span>(<span class="st">"Age_2020"</span>, <span class="st">"Age_2021"</span>, <span class="st">"Age_2022"</span>), <span class="at">names_to =</span> <span class="st">"Year"</span>, <span class="at">values_to=</span><span class="st">"Age"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 √ó 3
  Name  Year       Age
  &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt;
1 A     Age_2020    20
2 A     Age_2021    21
3 A     Age_2022    22
4 B     Age_2020    30
5 B     Age_2021    31
6 B     Age_2022    32
7 C     Age_2020    40
8 C     Age_2021    41
9 C     Age_2022    42</code></pre>
</div>
</div>
<p>. . .</p>
<p>OK, but the year variable is a string but we want numbers.</p>
</section>
<section id="use-word" class="level2 smaller" data-number="1.3">
<h2 class="smaller anchored" data-number="1.3" data-anchor-id="use-word"><span class="header-section-number">1.3</span> Use <code>word</code></h2>
<p><code>word</code> extracts words from a sentence. However, the separator need not be <code>" "</code> but can be any character.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">word</span>(<span class="st">"This is a string."</span>, <span class="at">start=</span><span class="dv">2</span>, <span class="at">end=</span><span class="sc">-</span><span class="dv">2</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "is a"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Selects from the second to the second last word.</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">word</span>(<span class="st">"Age_2022"</span>, <span class="at">start=</span><span class="dv">2</span>, <span class="at">sep =</span> <span class="st">"_"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2022"</code></pre>
</div>
</div>
<p>. . .</p>
<p>It also works vectorized.</p>
<div class="cell" data-output-location="fragment">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> <span class="fu">pivot_longer</span>(<span class="fu">c</span>(<span class="st">"Age_2020"</span>, <span class="st">"Age_2021"</span>, <span class="st">"Age_2022"</span>), <span class="at">names_to =</span> <span class="st">"Year"</span>, <span class="at">values_to=</span><span class="st">"Age"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">word</span>(Year, <span class="at">start =</span> <span class="dv">2</span>, <span class="at">sep =</span> <span class="st">"_"</span>) <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 √ó 3
  Name   Year   Age
  &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
1 A      2020    20
2 A      2021    21
3 A      2022    22
4 B      2020    30
5 B      2021    31
6 B      2022    32
7 C      2020    40
8 C      2021    41
9 C      2022    42</code></pre>
</div>
</div>
</section>
<section id="string-detection-regular-expressions" class="level2 smaller" data-number="1.4">
<h2 class="smaller anchored" data-number="1.4" data-anchor-id="string-detection-regular-expressions"><span class="header-section-number">1.4</span> String Detection / Regular Expressions</h2>
<p>Many <code>stringr</code> function follow the structure <code>(string, pattern)</code>.<br>
<code>string</code> is in our data, <code>pattern</code> is a string interpreted as a <a href="https://en.wikipedia.org/wiki/Regular_expression"><strong>Regular Expressions</strong></a></p>
<p>A few examples show its power:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>fruits <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"apple"</span>, <span class="st">"pineapple"</span>, <span class="st">"Pear"</span>, <span class="st">"orange"</span>, <span class="st">"peach"</span>, <span class="st">"banana"</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str_detect</span>(fruits,<span class="st">"apple"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE  TRUE FALSE FALSE FALSE FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(fruits,<span class="st">"apple"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "apple" "apple" NA      NA      NA      NA     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(fruits,<span class="st">"[Pp][a-z]"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "pp" "pi" "Pe" NA   "pe" NA  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(fruits,<span class="st">"^[Pp][a-z]"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA   "pi" "Pe" NA   "pe" NA  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(fruits,<span class="st">"^[Pp][a-z]{3}"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA     "pine" "Pear" NA     "peac" NA    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(fruits,<span class="st">"^[Pp][a-z]+"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA          "pineapple" "Pear"      NA          "peach"     NA         </code></pre>
</div>
</div>
</section>
<section id="regular-expressions" class="level2 smaller" data-number="1.5">
<h2 class="smaller anchored" data-number="1.5" data-anchor-id="regular-expressions"><span class="header-section-number">1.5</span> Regular Expressions</h2>
<p><strong>Regular expressions</strong> (short <em>regexp</em> or <em>regex</em>): Character-Sequences specifying <em>match patterns</em>.</p>
<ul>
<li><p>Useful when strings contain unstructured or semi-structured data.</p></li>
<li><p>When you first look at a regexp, you‚Äôll think a cat walked across your keyboard, but as your understanding improves they will start to make sense. (Or you ask an AI chatbot to give you what you need üôÇ)</p></li>
</ul>
<p><strong>Guess what this regexp‚Äôs are to match?</strong></p>
<p><code>"^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+$"</code></p>
<p><code>"^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$"</code></p>
<p><code>""^[[:alnum:].-_]+@[[:alnum:].-]+$""</code></p>
<p>. . .</p>
<p>Email addresses! However, this is not the perfect solution‚Ä¶</p>
<p>Dig deeper: Read the discussion and see the example in <a href="https://stackoverflow.com/questions/201323/how-can-i-validate-an-email-address-using-a-regular-expression">How can I validate an email address using a regular expression?</a> at stackoverflow. # Special Values for ‚Äúno‚Äù data</p>
</section>
<section id="special-values" class="level2 smaller" data-number="1.6">
<h2 class="smaller anchored" data-number="1.6" data-anchor-id="special-values"><span class="header-section-number">1.6</span> Special values</h2>
<p>You should know the differences of special values.</p>
<ul>
<li><code>NA</code>: Not available (string, number, or whatever vector entry)</li>
<li><code>NULL</code>: Null object, the undefined object, e.g.&nbsp;an empty list or an empty list element</li>
<li><code>NaN</code>: For numbers: Meaning ‚ÄúNot a Number‚Äù (when math cannot solve what you want)</li>
<li><code>Inf</code>: For numbers: Positive infinity</li>
<li><code>-Inf</code>: For numbers: Negative infinity</li>
</ul>
<p>Check some math:</p>
<div class="cell" data-output-location="column-fragment">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">/</span><span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] Inf</code></pre>
</div>
</div>
<div class="cell" data-output-location="column-fragment">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -Inf</code></pre>
</div>
</div>
<div class="cell" data-output-location="column-fragment">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span><span class="sc">/</span><span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NaN</code></pre>
</div>
</div>
<div class="cell" data-output-location="column-fragment">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">/</span><span class="dv">0</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] Inf</code></pre>
</div>
</div>
<div class="cell" data-output-location="column-fragment">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">/</span><span class="dv">0</span> <span class="sc">-</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NaN</code></pre>
</div>
</div>
</section>
<section id="nas" class="level2 smaller" data-number="1.7">
<h2 class="smaller anchored" data-number="1.7" data-anchor-id="nas"><span class="header-section-number">1.7</span> <code>NA</code>s</h2>
<p>Instead of <code>NaN</code>, <code>NA</code> stands for genuinely unknown values.<br>
It can also be in a character of logical vector.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="cn">NA</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
   1.00    1.75    2.50    2.50    3.25    4.00       1 </code></pre>
</div>
</div>
<p>. . .</p>
<p>The type of <code>NA</code> is logical.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(<span class="cn">NA</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "logical"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(<span class="cn">NaN</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "double"</code></pre>
</div>
</div>
<p>Does it make sense? Let us look at <code>NA</code>‚Äôs in logical operations.</p>
</section>
<section id="nas-in-logical-operations" class="level2" data-number="1.8">
<h2 data-number="1.8" class="anchored" data-anchor-id="nas-in-logical-operations"><span class="header-section-number">1.8</span> <code>NA</code>s in logical operations</h2>
<p><code>NA</code> can be TRUE or FALSE.</p>
<p>Usually operations including <code>NA</code> results again in <code>NA</code>, but some not!</p>
<div class="cell" data-output-location="column-fragment">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="sc">&amp;</span> <span class="cn">TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
<div class="cell" data-output-location="column-fragment">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="sc">|</span> <span class="cn">TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<div class="cell" data-output-location="column-fragment">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="sc">&amp;</span> <span class="cn">FALSE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<div class="cell" data-output-location="column-fragment">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="sc">|</span> <span class="cn">FALSE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
<p>Understanding logical operations is important!</p>
</section>
<section id="null-is-the-null-object" class="level2 smaller" data-number="1.9">
<h2 class="smaller anchored" data-number="1.9" data-anchor-id="null-is-the-null-object"><span class="header-section-number">1.9</span> <code>NULL</code> is the null object</h2>
<ul>
<li>used to represent lists with zero length</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
</div>
<ul>
<li>used as a placeholder for missing values in lists and dataframes</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>L <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">a =</span> <span class="dv">1</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>L[[<span class="dv">3</span>]] <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>L</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$a
[1] 1

[[2]]
NULL

[[3]]
[1] 5</code></pre>
</div>
</div>
</section>
</section>
<section id="relational-data---joining" class="level1 page-columns page-full" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Relational Data - Joining</h1>
<section id="working-with-more-dataframes" class="level2 smaller page-columns page-full" data-number="2.1">
<h2 class="smaller anchored" data-number="2.1" data-anchor-id="working-with-more-dataframes"><span class="header-section-number">2.1</span> Working with more dataframes</h2>
<ul>
<li>Data can be distributed in several dataframes which have relations which each other.</li>
<li>For example, they share variables as the five dataframes in <code>nycflights13</code>.</li>
</ul>
<p><img src="img/nycflights13_data.png" height="300"></p>

<div class="no-row-height column-margin column-container"><div class="margin-aside">
<p>Often variables in different dataframe have the same name, but that need not be the case! See the variable <code>faa</code> in <code>airports</code> matches <code>origin</code> and <code>dest</code> in <code>flights</code>.</p>
</div></div></section>
<section id="data-women-in-science" class="level2 smaller page-columns page-full" data-number="2.2">
<h2 class="smaller anchored" data-number="2.2" data-anchor-id="data-women-in-science"><span class="header-section-number">2.2</span> Data: Women in science</h2>
<p>10 women in science who changed the world: Ada Lovelace, Marie Curie, Janaki Ammal, Chien-Shiung Wu, Katherine Johnson, Rosalind Franklin, Vera Rubin, Gladys West, Flossie Wong-Staal, Jennifer Doudna</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Professions</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Dates</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Works</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>professions <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/professions.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 10 Columns: 2
‚îÄ‚îÄ Column specification ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Delimiter: ","
chr (2): name, profession

‚Ñπ Use `spec()` to retrieve the full column specification for this data.
‚Ñπ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>professions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 √ó 2
   name               profession                        
   &lt;chr&gt;              &lt;chr&gt;                             
 1 Ada Lovelace       Mathematician                     
 2 Marie Curie        Physicist and Chemist             
 3 Janaki Ammal       Botanist                          
 4 Chien-Shiung Wu    Physicist                         
 5 Katherine Johnson  Mathematician                     
 6 Rosalind Franklin  Chemist                           
 7 Vera Rubin         Astronomer                        
 8 Gladys West        Mathematician                     
 9 Flossie Wong-Staal Virologist and Molecular Biologist
10 Jennifer Doudna    Biochemist                        </code></pre>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>dates <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/dates.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 8 Columns: 3
‚îÄ‚îÄ Column specification ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Delimiter: ","
chr (1): name
dbl (2): birth_year, death_year

‚Ñπ Use `spec()` to retrieve the full column specification for this data.
‚Ñπ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>dates</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 √ó 3
  name               birth_year death_year
  &lt;chr&gt;                   &lt;dbl&gt;      &lt;dbl&gt;
1 Janaki Ammal             1897       1984
2 Chien-Shiung Wu          1912       1997
3 Katherine Johnson        1918       2020
4 Rosalind Franklin        1920       1958
5 Vera Rubin               1928       2016
6 Gladys West              1930         NA
7 Flossie Wong-Staal       1947         NA
8 Jennifer Doudna          1964         NA</code></pre>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>works <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/works.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 9 Columns: 2
‚îÄ‚îÄ Column specification ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Delimiter: ","
chr (2): name, known_for

‚Ñπ Use `spec()` to retrieve the full column specification for this data.
‚Ñπ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>works</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 √ó 2
  name               known_for                                                  
  &lt;chr&gt;              &lt;chr&gt;                                                      
1 Ada Lovelace       first computer algorithm                                   
2 Marie Curie        theory of radioactivity,  discovery of elements polonium a‚Ä¶
3 Janaki Ammal       hybrid species, biodiversity protection                    
4 Chien-Shiung Wu    confim and refine theory of radioactive beta decy, Wu expe‚Ä¶
5 Katherine Johnson  calculations of orbital mechanics critical to sending the ‚Ä¶
6 Vera Rubin         existence of dark matter                                   
7 Gladys West        mathematical modeling of the shape of the Earth which serv‚Ä¶
8 Flossie Wong-Staal first scientist to clone HIV and create a map of its genes‚Ä¶
9 Jennifer Doudna    one of the primary developers of CRISPR, a ground-breaking‚Ä¶</code></pre>
</div>
</div>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="margin-aside">
<p>Source: <a href="https://www.discovermagazine.com/the-sciences/meet-10-women-in-science-who-changed-the-world">Discover Magazine</a></p>
<p>The data can be downloaded: <a href="https://raw.githubusercontent.com/rstudio-education/datascience-box/main/course-materials/_slides/u2-d08-multi-df/data/scientists/professions.csv">professions.csv</a>, <a href="https://raw.githubusercontent.com/rstudio-education/datascience-box/main/course-materials/_slides/u2-d08-multi-df/data/scientists/dates.csv">dates.csv</a>, <a href="https://raw.githubusercontent.com/rstudio-education/datascience-box/main/course-materials/_slides/u2-d08-multi-df/data/scientists/works.csv">works.csv</a></p>
</div></div></section>
<section id="we-want-this-dataframe" class="level2 smaller" data-number="2.3">
<h2 class="smaller anchored" data-number="2.3" data-anchor-id="we-want-this-dataframe"><span class="header-section-number">2.3</span> We want this dataframe</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>professions  <span class="sc">|&gt;</span> <span class="fu">left_join</span>(dates) <span class="sc">|&gt;</span> <span class="fu">left_join</span>(works)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(name)`
Joining with `by = join_by(name)`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 √ó 5
   name               profession                 birth_year death_year known_for
   &lt;chr&gt;              &lt;chr&gt;                           &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;    
 1 Ada Lovelace       Mathematician                      NA         NA first co‚Ä¶
 2 Marie Curie        Physicist and Chemist              NA         NA theory o‚Ä¶
 3 Janaki Ammal       Botanist                         1897       1984 hybrid s‚Ä¶
 4 Chien-Shiung Wu    Physicist                        1912       1997 confim a‚Ä¶
 5 Katherine Johnson  Mathematician                    1918       2020 calculat‚Ä¶
 6 Rosalind Franklin  Chemist                          1920       1958 &lt;NA&gt;     
 7 Vera Rubin         Astronomer                       1928       2016 existenc‚Ä¶
 8 Gladys West        Mathematician                    1930         NA mathemat‚Ä¶
 9 Flossie Wong-Staal Virologist and Molecular ‚Ä¶       1947         NA first sc‚Ä¶
10 Jennifer Doudna    Biochemist                       1964         NA one of t‚Ä¶</code></pre>
</div>
</div>
</section>
<section id="joining-dataframes" class="level2 smaller" data-number="2.4">
<h2 class="smaller anchored" data-number="2.4" data-anchor-id="joining-dataframes"><span class="header-section-number">2.4</span> Joining dataframes</h2>
<p><code>something_join(x, y)</code><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> for dataframes <code>x</code> and <code>y</code> which have a <em>relation</em></p>
<ul>
<li><code>left_join()</code>: all rows from x</li>
<li><code>right_join()</code>: all rows from y</li>
<li><code>full_join()</code>: all rows from both x and y</li>
<li><code>inner_join()</code>: all rows from x where there are matching values in y, return all combination of multiple matches in the case of multiple matches</li>
<li>‚Ä¶</li>
</ul>
</section>
<section id="simple-setup-for-x-and-y" class="level2 smaller" data-number="2.5">
<h2 class="smaller anchored" data-number="2.5" data-anchor-id="simple-setup-for-x-and-y"><span class="header-section-number">2.5</span> Simple setup for <code>x</code> and <code>y</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">value_x =</span> <span class="fu">c</span>(<span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>)</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>),</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">value_y =</span> <span class="fu">c</span>(<span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y4"</span>)</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 √ó 2
     id value_x
  &lt;dbl&gt; &lt;chr&gt;  
1     1 x1     
2     2 x2     
3     3 x3     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 √ó 2
     id value_y
  &lt;dbl&gt; &lt;chr&gt;  
1     1 y1     
2     2 y2     
3     4 y4     </code></pre>
</div>
</div>
</section>
<section id="left_join" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="left_join"><span class="header-section-number">2.6</span> <code>left_join()</code></h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img src="img/left-join.gif" class="img-fluid"></p>
</div><div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(x, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(id)`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 √ó 3
     id value_x value_y
  &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;  
1     1 x1      y1     
2     2 x2      y2     
3     3 x3      &lt;NA&gt;   </code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="right_join" class="level2" data-number="2.7">
<h2 data-number="2.7" class="anchored" data-anchor-id="right_join"><span class="header-section-number">2.7</span> <code>right_join()</code></h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img src="img/right-join.gif" class="img-fluid"></p>
</div><div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">right_join</span>(x, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(id)`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 √ó 3
     id value_x value_y
  &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;  
1     1 x1      y1     
2     2 x2      y2     
3     4 &lt;NA&gt;    y4     </code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="full_join" class="level2" data-number="2.8">
<h2 data-number="2.8" class="anchored" data-anchor-id="full_join"><span class="header-section-number">2.8</span> <code>full_join()</code></h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img src="img/full-join.gif" class="img-fluid"></p>
</div><div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">full_join</span>(x, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(id)`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 √ó 3
     id value_x value_y
  &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;  
1     1 x1      y1     
2     2 x2      y2     
3     3 x3      &lt;NA&gt;   
4     4 &lt;NA&gt;    y4     </code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="inner_join" class="level2" data-number="2.9">
<h2 data-number="2.9" class="anchored" data-anchor-id="inner_join"><span class="header-section-number">2.9</span> <code>inner_join()</code></h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img src="img/inner-join.gif" class="img-fluid"></p>
</div><div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">inner_join</span>(x, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(id)`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 √ó 3
     id value_x value_y
  &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;  
1     1 x1      y1     
2     2 x2      y2     </code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="women-in-science" class="level2 smaller" data-number="2.10">
<h2 class="smaller anchored" data-number="2.10" data-anchor-id="women-in-science"><span class="header-section-number">2.10</span> Women in science</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true"><code>left_join</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false"><code>right_join</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false"><code>full_join</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false"><code>inner_join</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-5" role="tab" aria-controls="tabset-2-5" aria-selected="false">Final</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>professions <span class="sc">|&gt;</span> <span class="fu">left_join</span>(works)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(name)`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 √ó 3
   name               profession                         known_for              
   &lt;chr&gt;              &lt;chr&gt;                              &lt;chr&gt;                  
 1 Ada Lovelace       Mathematician                      first computer algorit‚Ä¶
 2 Marie Curie        Physicist and Chemist              theory of radioactivit‚Ä¶
 3 Janaki Ammal       Botanist                           hybrid species, biodiv‚Ä¶
 4 Chien-Shiung Wu    Physicist                          confim and refine theo‚Ä¶
 5 Katherine Johnson  Mathematician                      calculations of orbita‚Ä¶
 6 Rosalind Franklin  Chemist                            &lt;NA&gt;                   
 7 Vera Rubin         Astronomer                         existence of dark matt‚Ä¶
 8 Gladys West        Mathematician                      mathematical modeling ‚Ä¶
 9 Flossie Wong-Staal Virologist and Molecular Biologist first scientist to clo‚Ä¶
10 Jennifer Doudna    Biochemist                         one of the primary dev‚Ä¶</code></pre>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>professions <span class="sc">|&gt;</span> <span class="fu">right_join</span>(works)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(name)`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 √ó 3
  name               profession                         known_for               
  &lt;chr&gt;              &lt;chr&gt;                              &lt;chr&gt;                   
1 Ada Lovelace       Mathematician                      first computer algorithm
2 Marie Curie        Physicist and Chemist              theory of radioactivity‚Ä¶
3 Janaki Ammal       Botanist                           hybrid species, biodive‚Ä¶
4 Chien-Shiung Wu    Physicist                          confim and refine theor‚Ä¶
5 Katherine Johnson  Mathematician                      calculations of orbital‚Ä¶
6 Vera Rubin         Astronomer                         existence of dark matter
7 Gladys West        Mathematician                      mathematical modeling o‚Ä¶
8 Flossie Wong-Staal Virologist and Molecular Biologist first scientist to clon‚Ä¶
9 Jennifer Doudna    Biochemist                         one of the primary deve‚Ä¶</code></pre>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>dates <span class="sc">|&gt;</span> <span class="fu">full_join</span>(works)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(name)`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 √ó 4
   name               birth_year death_year known_for                           
   &lt;chr&gt;                   &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;                               
 1 Janaki Ammal             1897       1984 hybrid species, biodiversity protec‚Ä¶
 2 Chien-Shiung Wu          1912       1997 confim and refine theory of radioac‚Ä¶
 3 Katherine Johnson        1918       2020 calculations of orbital mechanics c‚Ä¶
 4 Rosalind Franklin        1920       1958 &lt;NA&gt;                                
 5 Vera Rubin               1928       2016 existence of dark matter            
 6 Gladys West              1930         NA mathematical modeling of the shape ‚Ä¶
 7 Flossie Wong-Staal       1947         NA first scientist to clone HIV and cr‚Ä¶
 8 Jennifer Doudna          1964         NA one of the primary developers of CR‚Ä¶
 9 Ada Lovelace               NA         NA first computer algorithm            
10 Marie Curie                NA         NA theory of radioactivity,  discovery‚Ä¶</code></pre>
</div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>dates <span class="sc">|&gt;</span> <span class="fu">inner_join</span>(works)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(name)`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 √ó 4
  name               birth_year death_year known_for                            
  &lt;chr&gt;                   &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;                                
1 Janaki Ammal             1897       1984 hybrid species, biodiversity protect‚Ä¶
2 Chien-Shiung Wu          1912       1997 confim and refine theory of radioact‚Ä¶
3 Katherine Johnson        1918       2020 calculations of orbital mechanics cr‚Ä¶
4 Vera Rubin               1928       2016 existence of dark matter             
5 Gladys West              1930         NA mathematical modeling of the shape o‚Ä¶
6 Flossie Wong-Staal       1947         NA first scientist to clone HIV and cre‚Ä¶
7 Jennifer Doudna          1964         NA one of the primary developers of CRI‚Ä¶</code></pre>
</div>
</div>
</div>
<div id="tabset-2-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>professions <span class="sc">|&gt;</span> <span class="fu">left_join</span>(dates) <span class="sc">|&gt;</span> <span class="fu">left_join</span>(works)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(name)`
Joining with `by = join_by(name)`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 √ó 5
   name               profession                 birth_year death_year known_for
   &lt;chr&gt;              &lt;chr&gt;                           &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;    
 1 Ada Lovelace       Mathematician                      NA         NA first co‚Ä¶
 2 Marie Curie        Physicist and Chemist              NA         NA theory o‚Ä¶
 3 Janaki Ammal       Botanist                         1897       1984 hybrid s‚Ä¶
 4 Chien-Shiung Wu    Physicist                        1912       1997 confim a‚Ä¶
 5 Katherine Johnson  Mathematician                    1918       2020 calculat‚Ä¶
 6 Rosalind Franklin  Chemist                          1920       1958 &lt;NA&gt;     
 7 Vera Rubin         Astronomer                       1928       2016 existenc‚Ä¶
 8 Gladys West        Mathematician                    1930         NA mathemat‚Ä¶
 9 Flossie Wong-Staal Virologist and Molecular ‚Ä¶       1947         NA first sc‚Ä¶
10 Jennifer Doudna    Biochemist                       1964         NA one of t‚Ä¶</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="keys" class="level2 smaller" data-number="2.11">
<h2 class="smaller anchored" data-number="2.11" data-anchor-id="keys"><span class="header-section-number">2.11</span> Keys</h2>
<ul>
<li>A <strong>key</strong> is a variable or a set of variables which uniquely identifies observations</li>
<li>What was the key in the dataframe of women in science? <span class="fragment"><code>name</code></span></li>
</ul>
<p>. . .</p>
<ul>
<li>Switching back to <code>nycflights13</code> as example</li>
<li>In simple cases, a single variable is sufficient to identify an observation, e.g.&nbsp;each plane in <code>planes</code> is identified by <code>tailnum</code>.</li>
<li>Sometimes, multiple variables are needed; e.g.&nbsp;to identify an observation in <code>weather</code> you need five variables: <code>year</code>, <code>month</code>, <code>day</code>, <code>hour</code>, and <code>origin</code></li>
</ul>
</section>
<section id="how-can-we-check" class="level2 smaller scrollable" data-number="2.12">
<h2 class="smaller scrollable anchored" data-number="2.12" data-anchor-id="how-can-we-check"><span class="header-section-number">2.12</span> How can we check?</h2>
<p>Counting observation and filter those more than one</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nycflights13)</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>planes <span class="sc">|&gt;</span> <span class="fu">count</span>(tailnum) <span class="sc">|&gt;</span> <span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 √ó 2
# ‚Ñπ 2 variables: tailnum &lt;chr&gt;, n &lt;int&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>weather <span class="sc">|&gt;</span> <span class="fu">count</span>(year, month, day, hour, origin) <span class="sc">|&gt;</span> <span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">1</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 √ó 6
   year month   day  hour origin     n
  &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;int&gt;
1  2013    11     3     1 EWR        2
2  2013    11     3     1 JFK        2
3  2013    11     3     1 LGA        2</code></pre>
</div>
</div>
<p>OK, here 3 observations are twice, one for each airport. Probably this is related to <a href="https://en.wikipedia.org/wiki/Daylight_saving_time">Daylight saving time</a> in the US. In Fall clocks are turned back 1 hour. So this hour appears twice.</p>
<p>Example: Without hour it is not a key</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>weather <span class="sc">|&gt;</span> <span class="fu">count</span>(year, month, day, origin) <span class="sc">|&gt;</span> <span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,092 √ó 5
    year month   day origin     n
   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;int&gt;
 1  2013     1     1 EWR       22
 2  2013     1     1 JFK       22
 3  2013     1     1 LGA       23
 4  2013     1     2 EWR       24
 5  2013     1     2 JFK       24
 6  2013     1     2 LGA       24
 7  2013     1     3 EWR       24
 8  2013     1     3 JFK       24
 9  2013     1     3 LGA       24
10  2013     1     4 EWR       24
# ‚Ñπ 1,082 more rows</code></pre>
</div>
</div>
<p>Why do we have only 22 and 23 on day 1 of month 1? No idea. Dig deeper yourself!</p>
</section>
<section id="terminology-primary-and-foreign-keys" class="level2 smaller" data-number="2.13">
<h2 class="smaller anchored" data-number="2.13" data-anchor-id="terminology-primary-and-foreign-keys"><span class="header-section-number">2.13</span> Terminology: Primary and foreign keys</h2>
<ul>
<li><p>A <strong>primary key</strong> uniquely identifies an observation in its own table. E.g, <code>planes$tailnum</code> in <code>planes</code>.</p></li>
<li><p>A <strong>foreign key</strong> uniquely identifies an observation in another dataframe E.g. <code>flights$tailnum</code> is a foreign key in <code>flights</code> because it matches each flight to a unique plane in <code>planes</code>.</p></li>
<li><p>A primary key and a foreign key form a relation.</p></li>
<li><p>Relations are typically 1-to-many. Each plane has many flights</p></li>
<li><p>Relations can also be many-to-many. Airlines can fly to many airports; airport can host many airplanes.</p></li>
</ul>
</section>
<section id="joining-when-key-names-differ" class="level2 smaller scrollable" data-number="2.14">
<h2 class="smaller scrollable anchored" data-number="2.14" data-anchor-id="joining-when-key-names-differ"><span class="header-section-number">2.14</span> Joining when key names differ?</h2>
<p>We have to specify the key relation with a named vector in the <code>by</code> argument.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(flights)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 336776     19</code></pre>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> <span class="fu">left_join</span>(airports, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"dest"</span> <span class="ot">=</span> <span class="st">"faa"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 √ó 26
    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
 1  2013     1     1      517            515         2      830            819
 2  2013     1     1      533            529         4      850            830
 3  2013     1     1      542            540         2      923            850
 4  2013     1     1      544            545        -1     1004           1022
 5  2013     1     1      554            600        -6      812            837
 6  2013     1     1      554            558        -4      740            728
 7  2013     1     1      555            600        -5      913            854
 8  2013     1     1      557            600        -3      709            723
 9  2013     1     1      557            600        -3      838            846
10  2013     1     1      558            600        -2      753            745
# ‚Ñπ 336,766 more rows
# ‚Ñπ 18 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
#   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
#   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;, name &lt;chr&gt;, lat &lt;dbl&gt;,
#   lon &lt;dbl&gt;, alt &lt;dbl&gt;, tz &lt;dbl&gt;, dst &lt;chr&gt;, tzone &lt;chr&gt;</code></pre>
</div>
</div>
<p>The alternative (new default) version is to use the <code>join_by</code> function using the comparison sign <code>==</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> <span class="fu">left_join</span>(airports, <span class="fu">join_by</span>(<span class="st">"dest"</span> <span class="sc">==</span> <span class="st">"faa"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 √ó 26
    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
 1  2013     1     1      517            515         2      830            819
 2  2013     1     1      533            529         4      850            830
 3  2013     1     1      542            540         2      923            850
 4  2013     1     1      544            545        -1     1004           1022
 5  2013     1     1      554            600        -6      812            837
 6  2013     1     1      554            558        -4      740            728
 7  2013     1     1      555            600        -5      913            854
 8  2013     1     1      557            600        -3      709            723
 9  2013     1     1      557            600        -3      838            846
10  2013     1     1      558            600        -2      753            745
# ‚Ñπ 336,766 more rows
# ‚Ñπ 18 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
#   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
#   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;, name &lt;chr&gt;, lat &lt;dbl&gt;,
#   lon &lt;dbl&gt;, alt &lt;dbl&gt;, tz &lt;dbl&gt;, dst &lt;chr&gt;, tzone &lt;chr&gt;</code></pre>
</div>
</div>
<p><strong>Why does the number of rows stays the same after joining?</strong></p>
<p>. . .</p>
<p><code>faa</code> is a primary key in <code>airports</code>. It is matched with <code>dest</code> as the foreign key in <code>flights</code>.</p>
</section>
<section id="left_join-is-essentially-right_join-with-switched-dataframes" class="level2 smaller scrollable" data-number="2.15">
<h2 class="smaller scrollable anchored" data-number="2.15" data-anchor-id="left_join-is-essentially-right_join-with-switched-dataframes"><span class="header-section-number">2.15</span> <code>left_join</code> is <em>essentially</em> <code>right_join</code> with switched dataframes</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>airports_right_flights <span class="ot">&lt;-</span> airports <span class="sc">|&gt;</span> <span class="fu">right_join</span>(flights, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"faa"</span> <span class="ot">=</span> <span class="st">"dest"</span>))</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>airports_right_flights </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 √ó 26
   faa   name       lat   lon   alt    tz dst   tzone  year month   day dep_time
   &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;
 1 ABQ   Albuque‚Ä¶  35.0 -107.  5355    -7 A     Amer‚Ä¶  2013    10     1     1955
 2 ABQ   Albuque‚Ä¶  35.0 -107.  5355    -7 A     Amer‚Ä¶  2013    10     2     2010
 3 ABQ   Albuque‚Ä¶  35.0 -107.  5355    -7 A     Amer‚Ä¶  2013    10     3     1955
 4 ABQ   Albuque‚Ä¶  35.0 -107.  5355    -7 A     Amer‚Ä¶  2013    10     4     2017
 5 ABQ   Albuque‚Ä¶  35.0 -107.  5355    -7 A     Amer‚Ä¶  2013    10     5     1959
 6 ABQ   Albuque‚Ä¶  35.0 -107.  5355    -7 A     Amer‚Ä¶  2013    10     6     1959
 7 ABQ   Albuque‚Ä¶  35.0 -107.  5355    -7 A     Amer‚Ä¶  2013    10     7     2002
 8 ABQ   Albuque‚Ä¶  35.0 -107.  5355    -7 A     Amer‚Ä¶  2013    10     8     1957
 9 ABQ   Albuque‚Ä¶  35.0 -107.  5355    -7 A     Amer‚Ä¶  2013    10     9     1957
10 ABQ   Albuque‚Ä¶  35.0 -107.  5355    -7 A     Amer‚Ä¶  2013    10    10     2011
# ‚Ñπ 336,766 more rows
# ‚Ñπ 14 more variables: sched_dep_time &lt;int&gt;, dep_delay &lt;dbl&gt;, arr_time &lt;int&gt;,
#   sched_arr_time &lt;int&gt;, arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
#   tailnum &lt;chr&gt;, origin &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
#   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
</div>
</div>
<p>Differences</p>
<ul>
<li>In a join where keys have different column names the name of the first dataframe survives (unless you use <code>keep = TRUE</code>). Here, <code>faa</code> instead of <code>dest</code></li>
<li>The columns from the first dataframe come first</li>
<li>The order of rows is taken from the first dataframe, while duplication and dropping of variables is determined by the second dataframe (because it is a <code>right_join</code>)</li>
</ul>
<p>Using the fact that flights seem to be ordered by <code>year</code>, <code>month</code>, <code>day</code>, <code>dep_time</code> we can re-arrange:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>airports_right_flights <span class="sc">|&gt;</span> </span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">dest =</span> faa) <span class="sc">|&gt;</span> </span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">names</span>(flights)) <span class="sc">|&gt;</span> <span class="co"># Use order of flights</span></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(year, month, day, dep_time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 √ó 19
    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
 1  2013     1     1      517            515         2      830            819
 2  2013     1     1      533            529         4      850            830
 3  2013     1     1      542            540         2      923            850
 4  2013     1     1      544            545        -1     1004           1022
 5  2013     1     1      554            600        -6      812            837
 6  2013     1     1      554            558        -4      740            728
 7  2013     1     1      555            600        -5      913            854
 8  2013     1     1      557            600        -3      709            723
 9  2013     1     1      557            600        -3      838            846
10  2013     1     1      558            600        -2      924            917
# ‚Ñπ 336,766 more rows
# ‚Ñπ 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
#   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
#   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
</div>
</div>
<p>Note of caution: A deeper analysis shows that the order is still not exactly the same.</p>
</section>
<section id="left_join-with-reversed-dataframes" class="level2 smaller scrollable" data-number="2.16">
<h2 class="smaller scrollable anchored" data-number="2.16" data-anchor-id="left_join-with-reversed-dataframes"><span class="header-section-number">2.16</span> <code>left_join</code> with reversed dataframes</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(airports)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1458    8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(flights)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 336776     19</code></pre>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>airports <span class="sc">|&gt;</span> </span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(flights, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"faa"</span> <span class="ot">=</span> <span class="st">"dest"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 330,531 √ó 26
   faa   name      lat    lon   alt    tz dst   tzone  year month   day dep_time
   &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;
 1 04G   Lansdo‚Ä¶  41.1  -80.6  1044    -5 A     Amer‚Ä¶    NA    NA    NA       NA
 2 06A   Moton ‚Ä¶  32.5  -85.7   264    -6 A     Amer‚Ä¶    NA    NA    NA       NA
 3 06C   Schaum‚Ä¶  42.0  -88.1   801    -6 A     Amer‚Ä¶    NA    NA    NA       NA
 4 06N   Randal‚Ä¶  41.4  -74.4   523    -5 A     Amer‚Ä¶    NA    NA    NA       NA
 5 09J   Jekyll‚Ä¶  31.1  -81.4    11    -5 A     Amer‚Ä¶    NA    NA    NA       NA
 6 0A9   Elizab‚Ä¶  36.4  -82.2  1593    -5 A     Amer‚Ä¶    NA    NA    NA       NA
 7 0G6   Willia‚Ä¶  41.5  -84.5   730    -5 A     Amer‚Ä¶    NA    NA    NA       NA
 8 0G7   Finger‚Ä¶  42.9  -76.8   492    -5 A     Amer‚Ä¶    NA    NA    NA       NA
 9 0P2   Shoest‚Ä¶  39.8  -76.6  1000    -5 U     Amer‚Ä¶    NA    NA    NA       NA
10 0S9   Jeffer‚Ä¶  48.1 -123.    108    -8 A     Amer‚Ä¶    NA    NA    NA       NA
# ‚Ñπ 330,521 more rows
# ‚Ñπ 14 more variables: sched_dep_time &lt;int&gt;, dep_delay &lt;dbl&gt;, arr_time &lt;int&gt;,
#   sched_arr_time &lt;int&gt;, arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
#   tailnum &lt;chr&gt;, origin &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
#   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
</div>
</div>
<p><strong>Why does the number of rows changes after joining?</strong></p>
<p><code>dest</code> is not a primary key in <code>flights</code>. There are more flights with the same destination so rows of <code>airports</code> get duplicated.</p>
<p><strong>Why is the number of rows then less than the number of rows in flights?</strong><br>
336776 flights and 330531 airports left joined by flights.</p>
<p>Let us do some checks:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(airports<span class="sc">$</span>faa)) <span class="co"># Unique turns out to be redundant because faa is a primary key</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1458</code></pre>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(flights<span class="sc">$</span>dest))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 105</code></pre>
</div>
</div>
<p>There are much more airports then destinations in flights!<br>
‚Ä¶ but the rows of airports prevail when it is the first in a left_join.<br>
So, the dataframe should even <em>increase</em> because we get several rows of airports without flights.<br>
Let us dig deeper.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setdiff</span>( <span class="fu">unique</span>(airports<span class="sc">$</span>faa), <span class="fu">unique</span>(flights<span class="sc">$</span>dest)) <span class="sc">|&gt;</span> <span class="fu">length</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1357</code></pre>
</div>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setdiff</span>( <span class="fu">unique</span>(flights<span class="sc">$</span>dest), <span class="fu">unique</span>(airports<span class="sc">$</span>faa)) <span class="sc">|&gt;</span> <span class="fu">length</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
</div>
<p>1,357 airports have no flights!<br>
There are four destinations in flights, which are not in the airports list!</p>
<p>How many flights are to these?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dest <span class="sc">%in%</span> <span class="fu">setdiff</span>( <span class="fu">unique</span>(flights<span class="sc">$</span>dest), <span class="fu">unique</span>(airports<span class="sc">$</span>faa))) <span class="sc">|&gt;</span> </span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7602</code></pre>
</div>
</div>
<p>7,602 flights go to destinations not listed as airport</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(airports <span class="sc">|&gt;</span> <span class="fu">left_join</span>(flights, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"faa"</span> <span class="ot">=</span> <span class="st">"dest"</span>))) <span class="sc">==</span> <span class="fu">nrow</span>(flights) <span class="sc">+</span> <span class="dv">1357</span> <span class="sc">-</span> <span class="dv">7602</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>OK, now we have a clear picture:</p>
<p><code>airport</code> with left_joined <code>flights</code> duplicates the rows of <code>airports</code> for each flight flying to it. So the total number of rows is</p>
<ul>
<li>the number of flights</li>
<li>plus the number of airport which do not appear as a destination</li>
<li>minus the flights which go to destinations which are not listed in airports</li>
</ul>
<p><strong>Learning:</strong> The new number of observation after a join can be a complex combination of duplication and dropping.<br>
It is your responsibility to understand what is happening!</p>
</section>
</section>
<section id="math-sets-and-vectors" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Math: Sets and vectors</h1>
<section id="definition-sets-and-vectors" class="level2" data-background-color="aquamarine" data-number="3.1">
<h2 data-background-color="aquamarine" data-number="3.1" class="anchored" data-anchor-id="definition-sets-and-vectors"><span class="header-section-number">3.1</span> Definition: Sets and vectors</h2>
<p>A <strong>set</strong> is mathematical model for the <em>unordered</em> collection of <em>different</em> things (<strong>elements</strong>).</p>
<p>Examples</p>
<ul>
<li><span class="math inline">\(\{3, \text{Hi}, üòÄ, üññ \}\)</span></li>
<li><span class="math inline">\(\{1,3,5\}\)</span></li>
<li>The natural numbers <span class="math inline">\(\mathbb{N} = \{1, 2, 3, \dots\}\)</span> (infinite!)</li>
<li><span class="math inline">\(\{\mathtt{"EWR"}, \mathtt{"LGA"}, \mathtt{"JFK"}\}\)</span><br>
these are <code>origin</code> airports in <code>flights</code></li>
</ul>
</section>
<section id="math-sets-and-vectors-1" class="level2" data-background-color="aquamarine" data-number="3.2">
<h2 data-background-color="aquamarine" data-number="3.2" class="anchored" data-anchor-id="math-sets-and-vectors-1"><span class="header-section-number">3.2</span> Math: Sets and vectors</h2>
<p>A <strong>vector</strong> is an ordered collection of things (<strong>components</strong>) of the same type.</p>
<p>In a set, each thing can only be once and the order does not matter!</p>
<p><span class="math inline">\(\{1,3,5\} = \{3,5,1\} = \{1,1,1,3,5,5\}\)</span></p>
<p>For vectors:</p>
<p><span class="math inline">\([1\ 3\ 5] \neq [3\ 5\ 1]\)</span> because we compare component-wise, so we cannot even compare with those with the vector <span class="math inline">\([1\ 1\ 1\ 3\ 5\ 5]\)</span></p>
</section>
<section id="math-set-operations" class="level2" data-background-color="aquamarine" data-number="3.3">
<h2 data-background-color="aquamarine" data-number="3.3" class="anchored" data-anchor-id="math-set-operations"><span class="header-section-number">3.3</span> Math: Set operations</h2>
<p>Sets <span class="math inline">\(A = \{üê∫, ü¶ä, üê∂\}\)</span> and <span class="math inline">\(B = \{üê∂, üê∑, üêπ\}\)</span>, <span class="math inline">\(C = \{üê∂, üê∑\}\)</span>:</p>
<div class="incremental">
<ul class="incremental">
<li>Set <strong>union</strong> <span class="math inline">\(A \cup B\)</span> = {üê∫, ü¶ä, üê∂, üê∑, üêπ}<br>
<span class="math inline">\(x \in A \cup B\)</span> when <span class="math inline">\(x \in A\)</span> <code>|</code> (or) <span class="math inline">\(x\in B\)</span></li>
<li>Set <strong>intersection</strong> <span class="math inline">\(A \cap B\)</span> = {üê∂}<br>
<span class="math inline">\(x \in A \cap B\)</span> when <span class="math inline">\(x \in A\)</span> <code>&amp;</code> (and) <span class="math inline">\(x\in B\)</span></li>
<li>Set <strong>difference</strong> <span class="math inline">\(A \setminus B = \{üê∫, ü¶ä\}\)</span>, <span class="math inline">\(B \setminus A\)</span> = {üê∑, üêπ}</li>
<li><strong>Subset</strong>: <span class="math inline">\(C \subset B\)</span> but <span class="math inline">\(C \not\subset A\)</span></li>
</ul>
</div>
<p>. . .</p>
<p>See the analogy of set operations and logical operations.</p>
</section>
<section id="set-operations-in-r" class="level2 smaller" data-number="3.4">
<h2 class="smaller anchored" data-number="3.4" data-anchor-id="set-operations-in-r"><span class="header-section-number">3.4</span> Set operations in R</h2>
<p><code>unique</code> shows the set of elements in a vector</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(flights<span class="sc">$</span>origin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "EWR" "LGA" "JFK"</code></pre>
</div>
</div>
<p>. . .</p>
<p><code>setequal</code> tests for set equality</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setequal</span>(<span class="fu">c</span>(<span class="st">"EWR"</span>,<span class="st">"LGA"</span>,<span class="st">"JFK"</span>), <span class="fu">c</span>(<span class="st">"EWR"</span>,<span class="st">"EWR"</span>,<span class="st">"LGA"</span>,<span class="st">"JFK"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>. . .</p>
<p><code>union</code>, <code>intersect</code>, <code>setdiff</code> treat vectors as sets and operate as expected</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">union</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3 4 5 6 7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">intersect</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3 4 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2</code></pre>
</div>
</div>
</section>
<section id="sets-take-away" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="sets-take-away"><span class="header-section-number">3.5</span> Sets: Take-away</h2>
<ul>
<li>Set operations are not a daily business in data science</li>
<li>However, they are useful for data exploration!</li>
<li>Knowing set operations is key to understand <strong>probability</strong>:
<ul>
<li>A <em>sample space</em> is the <em>set of all atomic events</em>.</li>
<li>An <em>event</em> is a <em>subset of the sample</em></li>
<li>A <em>probability function</em> assigns probabilities to all events.</li>
</ul></li>
</ul>
</section>
</section>
<section id="math-functions" class="level1 page-columns page-full" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Math: Functions</h1>
<section id="functions-mathematically" class="level2 page-columns page-full" data-background-color="aquamarine" data-number="4.1">
<h2 data-background-color="aquamarine" data-number="4.1" class="anchored" data-anchor-id="functions-mathematically"><span class="header-section-number">4.1</span> Functions mathematically</h2>
<p>Consider two sets: The <em>domain</em> <span class="math inline">\(X\)</span> and the <em>codomain</em> <span class="math inline">\(Y\)</span>.</p>
<p>A <em>function</em> <span class="math inline">\(f\)</span> assigns each element of <span class="math inline">\(X\)</span> to exactly one element of <span class="math inline">\(Y\)</span>.</p>
<div class="columns">
<div class="column" style="width:50%;">
<p>We write <span class="math inline">\(f : X \to  Y\)</span><br>
<span style="color:blue;">‚Äú<span class="math inline">\(f\)</span> maps from <span class="math inline">\(X\)</span> to <span class="math inline">\(Y\)</span>‚Äù</span></p>
<p>and <span class="math inline">\(x \mapsto f(x)\)</span><br>
<span style="color:blue;">‚Äú<span class="math inline">\(x\)</span> maps to <span class="math inline">\(f(x)\)</span>‚Äù</span></p>
<p>The yellow set is called the <em>image</em> of <span class="math inline">\(f\)</span>.</p>
</div><div class="column">
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/64/Codomain2.SVG/375px-Codomain2.SVG.png" class="img-fluid"></p>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="margin-aside">
<p>Picture from wikipedia.</p>
</div></div></section>
<section id="conventions-in-mathematical-text" class="level2 smaller" data-background-color="aquamarine" data-number="4.2">
<h2 class="smaller anchored" data-background-color="aquamarine" data-number="4.2" data-anchor-id="conventions-in-mathematical-text"><span class="header-section-number">4.2</span> Conventions in mathematical text</h2>
<ul>
<li>Sets are denoted with capital letters.</li>
<li>Their elements with (corresponding) small letters.</li>
<li>Functions are often called <span class="math inline">\(f\)</span>, <span class="math inline">\(g\)</span>, or <span class="math inline">\(h\)</span>.</li>
<li>Other terminology can be used!</li>
</ul>
<p>. . .</p>
<p><strong>Important in math</strong></p>
<ul>
<li>When you read math:<br>
<em>Keep track of what objects are! What are functions, what are sets, what are numbers, ‚Ä¶</em><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></li>
<li>When you write math: <em>Define what objects are.</em></li>
</ul>
</section>
<section id="is-this-a-mathematical-function" class="level2 smaller" data-number="4.3">
<h2 class="smaller anchored" data-number="4.3" data-anchor-id="is-this-a-mathematical-function"><span class="header-section-number">4.3</span> Is this a mathematical function?</h2>
<p><img src="img/function_lionfilter_input_Jan.jpeg" height="200"> <span class="math inline">\(\ \mapsto\ \)</span> <img src="img/function_lionfilter_Jan.jpg" height="200"></p>
<p><em>Input</em> from <span class="math inline">\(X = \{\text{A picture where a face can be recognized}\}\)</span>.</p>
<p><em>Function:</em> Upload input at <a href="https://funny.pho.to/lion/" class="uri">https://funny.pho.to/lion/</a> and download output.</p>
<p><em>Output</em> from <span class="math inline">\(Y = \{\text{Set of pictures with a specific format.}\}\)</span></p>
<p>. . .</p>
<p>Yes, it is a function. <strong>Important: Output is the same for the same input!</strong></p>
</section>
<section id="is-this-a-mathematical-function-1" class="level2 smaller" data-number="4.4">
<h2 class="smaller anchored" data-number="4.4" data-anchor-id="is-this-a-mathematical-function-1"><span class="header-section-number">4.4</span> Is this a mathematical function?</h2>
<p><em>Input</em> a text snippet. <em>Function:</em> Enter text at <a href="https://www.craiyon.com" class="uri">https://www.craiyon.com</a>. <em>Output</em> a picture.</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img src="img/craiyon-DataScienceConcepts.png" height="430"></p>
</div><div class="column">
<p>Other examples:</p>
<ul>
<li>‚ÄúNuclear explosion broccoli‚Äù</li>
<li>‚ÄúThe Eye of Sauron reading a newspaper‚Äù</li>
<li>‚ÄúThe legendary attack of Hamster Godzilla wearing a tiny Sombrero‚Äù</li>
</ul>
<p><img src="img/Nuclear exposion broccoli.png" height="150"> <img src="img/The Eye of Sauron reading a newspaper.png" height="150"> <img src="img/The legendary attack of Hamster Godzilla wearing a tiny Sombrero.png" height="150"></p>
</div>
</div>
<p>. . .</p>
<p>No, it is not a function. It has nine outcomes and these change when run again.</p>
</section>
</section>
<section id="functions-graphs-shift-and-scale-polynomial-vs.-exponential" class="level1 page-columns page-full" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Functions: Graphs, Shift and Scale, Polynomial vs.&nbsp;Exponential</h1>
<section id="graphs-of-functions" class="level2 smaller" data-background-color="aquamarine" data-number="5.1">
<h2 class="smaller anchored" data-background-color="aquamarine" data-number="5.1" data-anchor-id="graphs-of-functions"><span class="header-section-number">5.1</span> Graphs of functions</h2>
<ul>
<li>A function is characterized by the set all possible pairs <span class="math inline">\((x,f(x))\)</span>.</li>
<li>This is called its <em>graph</em>.</li>
<li>When domain and codomain are real numbers then the graph can be shown in a <em>Cartesian coordinate system</em>. Example <span class="math inline">\(f(x) = x^3 - x^2\)</span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) x<span class="sc">^</span><span class="dv">3</span> <span class="sc">-</span> x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="fl">1.5</span>)) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"x"</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="W04_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<!-- ## Higher dimensional input and output -->
<!-- Function can take $m$-dimensional input vectors and $n$-dimensional output vectors $f : \mathbb{R}^m \to \mathbb{R}^n$.  -->
</section>
<section id="some-functions-f-mathbbr-to-mathbbr" class="level2 smaller page-columns page-full" data-background-color="aquamarine" data-number="5.2">
<h2 class="smaller anchored" data-background-color="aquamarine" data-number="5.2" data-anchor-id="some-functions-f-mathbbr-to-mathbbr"><span class="header-section-number">5.2</span> Some functions <span class="math inline">\(f: \mathbb{R} \to \mathbb{R}\)</span></h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><span class="math inline">\(f(x) = x\)</span> <em>identity function</em><br>
<span style="color:orange;"><span class="math inline">\(f(x) = x^2\)</span> <em>square function</em></span><br>
<span style="color:blue;"><span class="math inline">\(f(x) = \sqrt{x}\)</span> <em>square root function</em></span><br>
<span style="color:red;"><span class="math inline">\(f(x) = e^x\)</span> <em>exponential function</em></span><br>
<span style="color:green;"><span class="math inline">\(f(x) = \log(x)\)</span> <em>natural logarithm</em></span></p>
<ul>
<li>Square and square root function are <em>inverse</em> of each other. Exponential and natural logarithm, too.</li>
</ul>
<p><span class="math inline">\(\sqrt[2]{x}^2 = \sqrt[2]{x^2} = x\)</span>, <span class="math inline">\(\log(e^x) = e^{\log(x)} = x\)</span></p>
<ul>
<li>Identity function graph as mirror axis.</li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) x) <span class="sc">+</span> </span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(x), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) <span class="fu">log</span>(x), <span class="at">color =</span> <span class="st">"green"</span>) <span class="sc">+</span> </span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) x<span class="sc">^</span><span class="dv">2</span>, <span class="at">color =</span> <span class="st">"orange"</span>) <span class="sc">+</span> </span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) <span class="fu">sqrt</span>(x), <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span> </span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">3</span>))<span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">3</span>)) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"x"</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in log(x): NaNs produced</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in sqrt(x): NaNs produced</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 32 rows containing missing values or values outside the scale range
(`geom_function()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 50 rows containing missing values or values outside the scale range
(`geom_function()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 44 rows containing missing values or values outside the scale range
(`geom_function()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 50 rows containing missing values or values outside the scale range
(`geom_function()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="W04_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="margin-aside">
<p><span class="math inline">\(e\)</span> is <em>Euler‚Äôs number</em> <span class="math inline">\(2.71828\dots\)</span>. The natural logarithm is also often called <span class="math inline">\(\ln\)</span>. The square root function is <span class="math inline">\(\mathbb{R}_{\geq 0} \to \mathbb{R}\)</span>, the logarithm <span class="math inline">\(\mathbb{R}_{&gt;0} \to \mathbb{R}\)</span>.</p>
</div></div></section>
<section id="shifts-and-scales" class="level2 smaller scrollable" data-background-color="aquamarine" data-number="5.3">
<h2 class="smaller scrollable anchored" data-background-color="aquamarine" data-number="5.3" data-anchor-id="shifts-and-scales"><span class="header-section-number">5.3</span> Shifts and scales</h2>
<p>How can we shift, stretch, or shrink a graph vertically and horizontally?</p>
<p>. . .</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true"><span class="math inline">\(y\)</span>-shift</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false"><span class="math inline">\(x\)</span>-shift</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false"><span class="math inline">\(y\)</span>-scale</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false"><span class="math inline">\(x\)</span>-scale</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="columns">
<div class="column" style="width:50%;">
<p>Add a constant to the function.</p>
<p><span class="math inline">\(f(x) = x^3 - x^2 \leadsto\)</span></p>
<p><span class="math inline">\(\quad f(x) = x^3 - x^2 + a\)</span></p>
<p>For <span class="math inline">\(a =\)</span> <span style="color:red;">-2</span>, <span style="color:darkred;">-0.5</span>, <span style="color:darkblue;">0.5</span>, <span style="color:blue;">2</span></p>
</div><div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.5</span>, <span class="dv">2</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="sc">-</span><span class="dv">2</span>)</span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) x<span class="sc">^</span><span class="dv">3</span> <span class="sc">-</span> x<span class="sc">^</span><span class="dv">2</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) x<span class="sc">^</span><span class="dv">3</span> <span class="sc">-</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span>a[<span class="dv">2</span>], <span class="at">color =</span> <span class="st">"blue4"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) x<span class="sc">^</span><span class="dv">3</span> <span class="sc">-</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span>a[<span class="dv">3</span>], <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) x<span class="sc">^</span><span class="dv">3</span> <span class="sc">-</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span>a[<span class="dv">4</span>], <span class="at">color =</span> <span class="st">"red4"</span>) <span class="sc">+</span></span>
<span id="cb166-6"><a href="#cb166-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) x<span class="sc">^</span><span class="dv">3</span> <span class="sc">-</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span>a[<span class="dv">5</span>], <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb166-7"><a href="#cb166-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span> <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">3</span>)) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">3</span>)) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"x"</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">24</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
‚Ñπ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 50 rows containing missing values or values outside the scale range
(`geom_function()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 51 rows containing missing values or values outside the scale range
(`geom_function()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 53 rows containing missing values or values outside the scale range
(`geom_function()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 50 rows containing missing values or values outside the scale range
(`geom_function()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 53 rows containing missing values or values outside the scale range
(`geom_function()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="W04_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Subtract</strong> a constant from all <span class="math inline">\(x\)</span> within the function definition.</p>
<p><span class="math inline">\(f(x) = x^3 - x^2 \leadsto\)</span></p>
<p><span class="math inline">\(\quad f(x) = (x - a)^3 - (x - a)^2\)</span></p>
<p>For <span class="math inline">\(a =\)</span> <span style="color:red;">-2</span>, <span style="color:darkred;">-0.5</span>, <span style="color:darkblue;">0.5</span>, <span style="color:blue;">2</span></p>
<p><strong>Attention:</strong><br>
Shifting <span class="math inline">\(a\)</span> units to the right needs subtracting <span class="math inline">\(a\)</span>!<br>
You can think of the <em>coordinate system being shifted</em> in direction <span class="math inline">\(a\)</span> while the graph stays.</p>
</div><div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.5</span>, <span class="dv">2</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="sc">-</span><span class="dv">2</span>)</span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) x<span class="sc">^</span><span class="dv">3</span> <span class="sc">-</span> x<span class="sc">^</span><span class="dv">2</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) (x<span class="sc">-</span>a[<span class="dv">2</span>])<span class="sc">^</span><span class="dv">3</span> <span class="sc">-</span> (x<span class="sc">-</span>a[<span class="dv">2</span>])<span class="sc">^</span><span class="dv">2</span>, <span class="at">color =</span> <span class="st">"blue4"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) (x<span class="sc">-</span>a[<span class="dv">3</span>])<span class="sc">^</span><span class="dv">3</span> <span class="sc">-</span> (x<span class="sc">-</span>a[<span class="dv">3</span>])<span class="sc">^</span><span class="dv">2</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) (x<span class="sc">-</span>a[<span class="dv">4</span>])<span class="sc">^</span><span class="dv">3</span> <span class="sc">-</span> (x<span class="sc">-</span>a[<span class="dv">4</span>])<span class="sc">^</span><span class="dv">2</span>, <span class="at">color =</span> <span class="st">"red4"</span>) <span class="sc">+</span></span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) (x<span class="sc">-</span>a[<span class="dv">5</span>])<span class="sc">^</span><span class="dv">3</span> <span class="sc">-</span> (x<span class="sc">-</span>a[<span class="dv">5</span>])<span class="sc">^</span><span class="dv">2</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb173-7"><a href="#cb173-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span> <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">3</span>)) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">3</span>)) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"x"</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">24</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 50 rows containing missing values or values outside the scale range
(`geom_function()`).
Removed 50 rows containing missing values or values outside the scale range
(`geom_function()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 64 rows containing missing values or values outside the scale range
(`geom_function()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 51 rows containing missing values or values outside the scale range
(`geom_function()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 53 rows containing missing values or values outside the scale range
(`geom_function()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="W04_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Multiply</strong> a constant to all <span class="math inline">\(x\)</span> within the function definition.</p>
<p><span class="math inline">\(f(x) = x^3 - x^2 \leadsto\)</span></p>
<p><span class="math inline">\(\quad f(x) = a(x^3 - x^2)\)</span></p>
<p>For <span class="math inline">\(a =\)</span> <span style="color:red;">-2</span>, <span style="color:darkred;">-0.5</span>, <span style="color:darkblue;">0.5</span>, <span style="color:blue;">2</span></p>
<p>Negative numbers flip the graph around the <span class="math inline">\(x\)</span>-axis.</p>
</div><div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.5</span>, <span class="dv">2</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="sc">-</span><span class="dv">2</span>)</span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) x<span class="sc">^</span><span class="dv">3</span> <span class="sc">-</span> x<span class="sc">^</span><span class="dv">2</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) a[<span class="dv">2</span>]<span class="sc">*</span>((x)<span class="sc">^</span><span class="dv">3</span> <span class="sc">-</span> (x)<span class="sc">^</span><span class="dv">2</span>), <span class="at">color =</span> <span class="st">"blue4"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) a[<span class="dv">3</span>]<span class="sc">*</span>((x)<span class="sc">^</span><span class="dv">3</span> <span class="sc">-</span> (x)<span class="sc">^</span><span class="dv">2</span>), <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) a[<span class="dv">4</span>]<span class="sc">*</span>((x)<span class="sc">^</span><span class="dv">3</span> <span class="sc">-</span> (x)<span class="sc">^</span><span class="dv">2</span>), <span class="at">color =</span> <span class="st">"red4"</span>) <span class="sc">+</span></span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) a[<span class="dv">5</span>]<span class="sc">*</span>((x)<span class="sc">^</span><span class="dv">3</span> <span class="sc">-</span> (x)<span class="sc">^</span><span class="dv">2</span>), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span> <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">3</span>)) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">3</span>)) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"x"</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">24</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 50 rows containing missing values or values outside the scale range
(`geom_function()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 39 rows containing missing values or values outside the scale range
(`geom_function()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 60 rows containing missing values or values outside the scale range
(`geom_function()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 39 rows containing missing values or values outside the scale range
(`geom_function()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 60 rows containing missing values or values outside the scale range
(`geom_function()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="W04_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Divide</strong> all <span class="math inline">\(x\)</span> within the function definition by a constant.</p>
<p><span class="math inline">\(f(x) = x^3 - x^2 \leadsto\)</span></p>
<p><span class="math inline">\(\quad f(x) = (x/a)^3 - (x/a)^2\)</span></p>
<p>For <span class="math inline">\(a =\)</span> <span style="color:red;">-2</span>, <span style="color:darkred;">-0.5</span>, <span style="color:darkblue;">0.5</span>, <span style="color:blue;">2</span></p>
<p>Negative numbers flip the graph around the <span class="math inline">\(y\)</span>-axis.</p>
<p><strong>Attention:</strong> Stretching needs a division by <span class="math inline">\(a\)</span>!<br>
You can think of the <em>coordinate system being stretched</em> multiplicatively by <span class="math inline">\(a\)</span> while the graph stays.</p>
</div><div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.5</span>, <span class="dv">2</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="sc">-</span><span class="dv">2</span>)</span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) x<span class="sc">^</span><span class="dv">3</span> <span class="sc">-</span> x<span class="sc">^</span><span class="dv">2</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) (x<span class="sc">/</span>a[<span class="dv">2</span>])<span class="sc">^</span><span class="dv">3</span> <span class="sc">-</span> (x<span class="sc">/</span>a[<span class="dv">2</span>])<span class="sc">^</span><span class="dv">2</span>, <span class="at">color =</span> <span class="st">"blue4"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) (x<span class="sc">/</span>a[<span class="dv">3</span>])<span class="sc">^</span><span class="dv">3</span> <span class="sc">-</span> (x<span class="sc">/</span>a[<span class="dv">3</span>])<span class="sc">^</span><span class="dv">2</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) (x<span class="sc">/</span>a[<span class="dv">4</span>])<span class="sc">^</span><span class="dv">3</span> <span class="sc">-</span> (x<span class="sc">/</span>a[<span class="dv">4</span>])<span class="sc">^</span><span class="dv">2</span>, <span class="at">color =</span> <span class="st">"red4"</span>) <span class="sc">+</span></span>
<span id="cb184-6"><a href="#cb184-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) (x<span class="sc">/</span>a[<span class="dv">5</span>])<span class="sc">^</span><span class="dv">3</span> <span class="sc">-</span> (x<span class="sc">/</span>a[<span class="dv">5</span>])<span class="sc">^</span><span class="dv">2</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb184-7"><a href="#cb184-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span> <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">3</span>)) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">3</span>)) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"x"</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">24</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 50 rows containing missing values or values outside the scale range
(`geom_function()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 76 rows containing missing values or values outside the scale range
(`geom_function()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 11 rows containing missing values or values outside the scale range
(`geom_function()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 76 rows containing missing values or values outside the scale range
(`geom_function()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 11 rows containing missing values or values outside the scale range
(`geom_function()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="W04_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="math-polynomials-and-exponentials" class="level2 smaller" data-background-color="aquamarine" data-number="5.4">
<h2 class="smaller anchored" data-background-color="aquamarine" data-number="5.4" data-anchor-id="math-polynomials-and-exponentials"><span class="header-section-number">5.4</span> Math: Polynomials and exponentials</h2>
<p>A <em>polynomial</em> is a function which is composed of (many) addends of the form <span class="math inline">\(ax^n\)</span> for different values of <span class="math inline">\(a\)</span> and <span class="math inline">\(n\)</span>.</p>
<p>In an <em>exponential</em> the <span class="math inline">\(x\)</span> appears in the exponent.</p>
<p><span class="math inline">\(f(x) = x^3\)</span> vs.&nbsp;<span style="color:red;"><span class="math inline">\(f(x) = e^x\)</span></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">=</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) x<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(x)<span class="sc">-</span><span class="dv">1</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>)) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"x"</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">18</span>)</span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">=</span> g1 <span class="sc">+</span> <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Scale for x is already present.
Adding another scale for x, which will replace the existing scale.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>g1 <span class="sc">+</span> g2 <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">"Same function but different of axis limits!"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="W04_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>For <span class="math inline">\(x\to\infty\)</span>, any exponential will finally ‚Äúovertake‚Äù any polynomial.</strong></p>
</section>
</section>
<section id="functions-in-programming-to-programming-function" class="level1 page-columns page-full" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Functions in Programming <span class="math inline">\(\to\)</span> Programming Function</h1>
<section id="input-to-output" class="level2 smaller page-columns page-full" data-number="6.1">
<h2 class="smaller anchored" data-number="6.1" data-anchor-id="input-to-output"><span class="header-section-number">6.1</span> Input <span class="math inline">\(\to\)</span> output</h2>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/3/3b/Function_machine2.svg" class="img-fluid"></p>
<ul>
<li>Metaphorically, a function is a <em>machine</em> or a <em>blackbox</em> that for each input yields an output.</li>
<li>The inputs of a function are also called <strong>arguments</strong>.</li>
</ul>
<p>. . .</p>
<p>Difference to math terminolgy:<br>
<strong>The output need not be the same for the same input.</strong></p>

<div class="no-row-height column-margin column-container"><div class="margin-aside">
<p>Picture from wikipedia.</p>
</div></div></section>
<section id="function-as-objects-in-r" class="level2 scrollable smaller" data-number="6.2">
<h2 class="scrollable smaller anchored" data-number="6.2" data-anchor-id="function-as-objects-in-r"><span class="header-section-number">6.2</span> Function as objects in R</h2>
<p><code>function</code> is a class of an object in R</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "function"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(ggplot2<span class="sc">::</span>ggplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "function"</code></pre>
</div>
</div>
<p>Calling the function without brackets writes its code or some information.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>sd <span class="co"># This function is written in R, and we see its code</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>function (x, na.rm = FALSE) 
sqrt(var(if (is.vector(x) || is.factor(x)) x else as.double(x), 
    na.rm = na.rm))
&lt;bytecode: 0x636b7f6d4430&gt;
&lt;environment: namespace:stats&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>c <span class="co"># This function is not written in R but is a R primitive</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>function (...)  .Primitive("c")</code></pre>
</div>
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span>ggplot <span class="co"># This function is not written solely in R</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>function (data = NULL, mapping = aes(), ..., environment = parent.frame()) 
{
    UseMethod("ggplot")
}
&lt;bytecode: 0x636b812a63b0&gt;
&lt;environment: namespace:ggplot2&gt;</code></pre>
</div>
</div>
</section>
<section id="define-your-own-functions-in-r" class="level2 smaller" data-number="6.3">
<h2 class="smaller anchored" data-number="6.3" data-anchor-id="define-your-own-functions-in-r"><span class="header-section-number">6.3</span> Define your own functions! (in R)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>add_one <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">+</span> <span class="dv">1</span> </span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Test it</span></span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true" tabindex="-1"></a><span class="fu">add_one</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11</code></pre>
</div>
</div>
<p>The skeleton for a function definition is</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a>function_name <span class="ot">&lt;-</span> <span class="cf">function</span>(input){</span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># do something with the input(s)</span></span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return something as output</span></span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><code>function_name</code> should be a short but evocative verb.</li>
<li>The <code>input</code> can be empty or one or more <code>name</code> or <code>name=expression</code> terms as arguments.</li>
<li>The last evaluated expression is returned as output.</li>
<li>When the body or the function is only one line <code>{}</code> can be omitted. For example<br>
<code>add_one &lt;- function(x) x + 1</code></li>
</ul>
</section>
<section id="flexibility-of-inputs-and-outputs" class="level2 smaller" data-number="6.4">
<h2 class="smaller anchored" data-number="6.4" data-anchor-id="flexibility-of-inputs-and-outputs"><span class="header-section-number">6.4</span> Flexibility of inputs and outputs</h2>
<ul>
<li>Arguments can be specified by <code>name=expression</code> or just <code>expression</code> (then they are taken as the next argument)</li>
<li>Default values for arguments can be provided. Useful when an argument is a parameter.</li>
</ul>
<div class="cell" data-output-location="column-fragment">
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a>mymult <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="dv">3</span>) x <span class="sc">*</span> (y <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mymult</span>(<span class="dv">3</span>,<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9</code></pre>
</div>
</div>
<div class="cell" data-output-location="column-fragment">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mymult</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
</div>
<div class="cell" data-output-location="column-fragment">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mymult</span>(<span class="at">y =</span> <span class="dv">3</span>, <span class="at">x =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12</code></pre>
</div>
</div>
<div class="cell" data-output-location="column-fragment">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mymult</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10</code></pre>
</div>
</div>
<div class="cell" data-output-location="column-fragment">
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mymult</span>(<span class="at">y =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
<p>. . .</p>
<p>For complex output use a list</p>
<div class="cell" data-output-location="column-fragment">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a>mymult <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="dv">3</span>) </span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">out1 =</span> x <span class="sc">*</span> (y <span class="sc">-</span> <span class="dv">1</span>), <span class="at">out2 =</span> x <span class="sc">*</span> (y <span class="sc">-</span> <span class="dv">2</span>))</span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mymult</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$out1
[1] 4

$out2
[1] 2</code></pre>
</div>
</div>
</section>
</section>
<section id="think-and-program-vectorized" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Think and program vectorized!</h1>
<section id="vectorized-functions" class="level2 smaller" data-number="7.1">
<h2 class="smaller anchored" data-number="7.1" data-anchor-id="vectorized-functions"><span class="header-section-number">7.1</span> Vectorized functions</h2>
<p>Mathematical functions in programming are often ‚Äúvectorized‚Äù:</p>
<ul>
<li>Operations on a single value are applied to each component of the vector.</li>
<li>Operations on two values are applied ‚Äúcomponent-wise‚Äù (for vectors of the same length)</li>
</ul>
<div class="cell" data-output-location="fragment">
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="fu">log10</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0 1 2 3 4</code></pre>
</div>
</div>
<div class="cell" data-output-location="fragment">
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>) <span class="sc">+</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4 2 2</code></pre>
</div>
</div>
<div class="cell" data-output-location="fragment">
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>(<span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>)<span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  0  1  4  9 16 25</code></pre>
</div>
</div>
</section>
<section id="recall-vector-creation-functions" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="recall-vector-creation-functions"><span class="header-section-number">7.2</span> Recall: Vector creation functions</h2>
<div class="cell" data-output-location="fragment">
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
</div>
</div>
<div class="cell" data-output-location="fragment">
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seq</span>(<span class="at">from=</span><span class="sc">-</span><span class="fl">0.5</span>, <span class="at">to=</span><span class="fl">1.5</span>, <span class="at">by=</span><span class="fl">0.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] -0.5 -0.4 -0.3 -0.2 -0.1  0.0  0.1  0.2  0.3  0.4  0.5  0.6  0.7  0.8  0.9
[16]  1.0  1.1  1.2  1.3  1.4  1.5</code></pre>
</div>
</div>
<div class="cell" data-output-location="fragment">
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, <span class="at">length.out=</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.0000000 0.1111111 0.2222222 0.3333333 0.4444444 0.5555556 0.6666667
 [8] 0.7777778 0.8888889 1.0000000</code></pre>
</div>
</div>
<div class="cell" data-output-location="fragment">
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">times=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3 1 2 3 1 2 3</code></pre>
</div>
</div>
<div class="cell" data-output-location="fragment">
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">each=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 1 1 2 2 2 3 3 3</code></pre>
</div>
</div>
</section>
<section id="plotting-and-transformation" class="level2 smaller" data-number="7.3">
<h2 class="smaller anchored" data-number="7.3" data-anchor-id="plotting-and-transformation"><span class="header-section-number">7.3</span> Plotting and transformation</h2>
<p><strong>Vector creation and vectorized functions</strong> are key for plotting and transformation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a>func <span class="ot">&lt;-</span> <span class="cf">function</span>(x) x<span class="sc">^</span><span class="dv">3</span> <span class="sc">-</span> x<span class="sc">^</span><span class="dv">2</span>    <span class="co"># Create a vectorized function</span></span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="fl">1.5</span>,<span class="at">by =</span><span class="fl">0.01</span>)) <span class="sc">|&gt;</span>    <span class="co"># Vector creation</span></span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">func</span>(x))        <span class="co"># Vectorized transformation using the function</span></span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(x,y)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="W04_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="conveniently-ggploting-functions" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="conveniently-ggploting-functions"><span class="header-section-number">7.4</span> Conveniently <code>ggplot</code>ing functions</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_function</span>(<span class="at">fun =</span> log) <span class="sc">+</span></span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) <span class="dv">3</span><span class="sc">*</span>x <span class="sc">-</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb235-4"><a href="#cb235-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="W04_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<p>Code line 3 shows another important concept: <strong>anonymous functions</strong>. The function <code>function(x) 3*x - 4</code> is defined <em>on the fly</em> without a name.</p>
</section>
</section>
<section id="conditional-statements-if-and-iteration-map" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Conditional Statements (<code>if</code>) and Iteration (<code>map</code>)</h1>
<section id="conditional-statements" class="level2 smaller" data-number="8.1">
<h2 class="smaller anchored" data-number="8.1" data-anchor-id="conditional-statements"><span class="header-section-number">8.1</span> Conditional statements</h2>
<ul>
<li><code>if</code> executes a code block if a condition is <code>TRUE</code></li>
<li><code>else</code> executes a code block if the condition is <code>FALSE</code></li>
</ul>
<p>Skeleton</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (condition) {</span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># code block</span></span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb236-4"><a href="#cb236-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># code block</span></span>
<span id="cb236-5"><a href="#cb236-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Example: A piece-wise defined function</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a>piecewise <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (x <span class="sc">&lt;</span> <span class="dv">2</span>) {</span>
<span id="cb237-3"><a href="#cb237-3" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.5</span> <span class="sc">*</span> x</span>
<span id="cb237-4"><a href="#cb237-4" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb237-5"><a href="#cb237-5" aria-hidden="true" tabindex="-1"></a>    x <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb237-6"><a href="#cb237-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb237-7"><a href="#cb237-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">piecewise</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="fu">piecewise</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="fu">piecewise</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
</div>
</div>
<p>. . .</p>
<p>Problem: <code>piecewise</code> is not vectorized. <code>piecewise(c(1,2,3))</code> does not work!</p>
</section>
<section id="vectorized-operations-with-map" class="level2 smaller" data-number="8.2">
<h2 class="smaller anchored" data-number="8.2" data-anchor-id="vectorized-operations-with-map"><span class="header-section-number">8.2</span> Vectorized operations with <code>map</code></h2>
<ul>
<li><code>map</code> functions apply a function to each element of a vector.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></li>
<li><code>map(.x, .f, ...)</code> applies the function <code>.f</code> to each element of the vector of <code>.x</code> and returns a <em>list</em>.</li>
<li><code>map_dbl</code> returns a double <em>vector</em> (other variants exist)</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), piecewise) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] 0.5

[[2]]
[1] 1

[[3]]
[1] 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map_dbl</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), piecewise) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5 1.0 2.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a>piecewise_vectorized <span class="ot">&lt;-</span> </span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a> <span class="cf">function</span>(x) <span class="fu">map_dbl</span>(x, piecewise) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="fu">piecewise_vectorized</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="at">by =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.00 0.25 0.50 0.75 1.00 1.50 2.00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="at">by =</span> <span class="fl">0.5</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">piecewise_vectorized</span>(x)) <span class="sc">|&gt;</span> </span>
<span id="cb251-3"><a href="#cb251-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x,y)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="W04_files/figure-html/unnamed-chunk-80-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="reduce" class="level2 smaller" data-number="8.3">
<h2 class="smaller anchored" data-number="8.3" data-anchor-id="reduce"><span class="header-section-number">8.3</span> <code>reduce</code></h2>
<p>Instead of a list or a vector <code>reduce</code> returns a single value.<br>
To that end it needs a function with two arguments. It applies it to the first two elements of the vector, then to the result and the third element, then the result and the fourth element, and so on.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">:</span><span class="dv">10</span> <span class="sc">|&gt;</span> <span class="fu">reduce</span>(\(x,y) x <span class="sc">+</span> y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 55</code></pre>
</div>
</div>
<p>Note: <code>\(x)</code> is a short way to write an <strong>anonymous function</strong> as <code>function(x)</code>.</p>
<p>. . .</p>
<p>Example: Reading multiple files</p>
<div class="columns">
<div class="column" style="width:50%;">
<p>Instead of</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span><span class="fu">read_csv</span>(<span class="st">"a.csv"</span>)</span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span><span class="fu">read_csv</span>(<span class="st">"b.csv"</span>)</span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span><span class="fu">read_csv</span>(<span class="st">"c.csv"</span>)</span>
<span id="cb254-4"><a href="#cb254-4" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span><span class="fu">read_csv</span>(<span class="st">"d.csv"</span>)</span>
<span id="cb254-5"><a href="#cb254-5" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span><span class="fu">read_csv</span>(<span class="st">"e.csv"</span>)</span>
<span id="cb254-6"><a href="#cb254-6" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span><span class="fu">read_csv</span>(<span class="st">"f.csv"</span>)</span>
<span id="cb254-7"><a href="#cb254-7" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span><span class="fu">read_csv</span>(<span class="st">"g.csv"</span>)</span>
<span id="cb254-8"><a href="#cb254-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-9"><a href="#cb254-9" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(a,b,c,d,e,f,g)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column" style="width:50%;">
<p>Write</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a>letter[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>] <span class="sc">|&gt;</span> </span>
<span id="cb255-2"><a href="#cb255-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">map</span>(\(x) <span class="fu">read_csv</span>(<span class="fu">paste0</span>(x,<span class="st">".csv"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb255-3"><a href="#cb255-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">reduce</span>(bind_rows)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="map-and-reduce" class="level2 smaller" data-number="8.4">
<h2 class="smaller anchored" data-number="8.4" data-anchor-id="map-and-reduce"><span class="header-section-number">8.4</span> <code>map</code> and <code>reduce</code></h2>
<ul>
<li><code>map</code> applies a function to each element of a vector (or list) and returns a list (or vector if <code>map_dbl</code> or other vaeriants are used)
<ul>
<li>The output has the same <code>length</code> as the input</li>
</ul></li>
<li><code>reduce</code> applies a function taking two arguments and then summarizes the list by applying them two element 1 and 2 and then again the result with element 3 and then the result with element 4, ‚Ä¶
<ul>
<li>The output is one object</li>
</ul></li>
<li>Remark: The problem of vectorizing a function which has an <code>if</code> and <code>else</code> statement (see the example <code>piecewise_vectorized</code>) can also be solved using the vectorized version of it:<br>
<code>if_else(condition = *condition*, true = *value-if_TRUE*, false = *value-if_FALSE*)</code><br>
Here every argument can be a vector!</li>
</ul>
</section>
<section id="function-programming-take-away" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="function-programming-take-away"><span class="header-section-number">8.5</span> Function programming: Take away</h2>
<ul>
<li>Functions are the most important building blocks of programming.</li>
<li>Functions can and often should be vectorized.</li>
<li>Vectorized functions are the basis for plotting and transformation.</li>
<li><code>map</code> functions are powerful tools for iterative tasks!<br>
<em>Expect to not get the idea first but to love them later.</em></li>
</ul>


</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>The notion <em>join</em> comes from SQL database. In other data manipulation frameworks joining is called <em>merging</em>.<a href="#fnref1" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
<li id="fn2"><p>Watch: How to read math <a href="https://www.youtube.com/watch?v=Kp2bYWRQylk" class="uri">https://www.youtube.com/watch?v=Kp2bYWRQylk</a><a href="#fnref2" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
<li id="fn3"><p>In <code>tidyverse</code> they are provided in the package <code>purrr</code><a href="#fnref3" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "Óßã";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>